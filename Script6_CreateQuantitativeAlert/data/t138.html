$(document).ready(function(){function b(a){var c=$(a).find("input:radio[name^=delimiter]:checked").val();return"none"===c?null:"others"===c?(a=$(a).find(".c_n_p_other_delimiter").val(),_.isEmpty(a)?null:a):c}$(document).on("click",".validate-copy-paste",function(a){var c=$(this).closest(".toAddContainerQEV")[0];a=$(c).find(".copyAndPasteModal").attr("id");var f=a.slice(a.indexOf("templateQuery"));a=$(c).find(".copyPasteContent").val();var d=b(c),e=$(getFieldFromExpression(c)).select2("val");null!=
d&&("|"==d&&(d="\\|"),a=a.replace(new RegExp("\\s*"+d+"\\s*","g"),";"));$.ajax({url:validateValue,type:"POST",mimeType:"multipart/form-data",data:{selectedField:e,qevId:f,values:a},success:function(a){a=JSON.parse(a);a.success&&g(c,a,f,!0)},error:function(a){console.error(a)}})});$(document).on("click",".confirm-paste",function(a){a.preventDefault();a=$(this).closest(".toAddContainerQEV")[0];var c=getValueTextFromExpression(a),f=$(a).find(".copyPasteContent").val(),d=b(a);$(getFieldFromExpression(a)).select2("val");
null!=d&&("|"==d&&(d="\\|"),f=f.replace(new RegExp("\\s*"+d+"\\s*","g"),";"));null==f||_.isEmpty(f)?$(c).val(""):($(c).val(f),$(a).find(".isFromCopyPaste").val("true"),$(getFieldFromExpression(a)).select2("val"),c=getValueSelectFromExpression(a),$(c).empty(),showHideValue(EDITOR_TYPE_TEXT,a))});$(document).on("click",".cancel",function(a){a.preventDefault();a=$(this).closest(".toAddContainerQEV")[0];$(a).find(".confirm-paste").show();$(a).find(".import-values").hide()});$(document).on("click",".import-values",
function(a){a.preventDefault();var c=$(this).closest(".toAddContainerQEV")[0];a=$(c).find(".copyAndPasteModal").attr("id");var b=a.slice(a.indexOf("templateQuery"));if($(c).find(":file").val()){a=$(c).find("#file_input");var d=new FormData;d.append("file",a.get(0).files[0]);d.append("qevId",b);d.append("selectedField",$(getFieldFromExpression(c)).select2("val"));$.ajax({url:importExcel,type:"POST",data:d,mimeType:"multipart/form-data",contentType:!1,cache:!1,processData:!1,success:function(a){$response=
$.parseJSON(a);$response.success?g(c,$response,b):($(c).find("#noDataInExcel").show().text($response.message),setTimeout(function(){$(c).find("#noDataInExcel").hide()},1E4))}})}});var g=function(a,c,b,d){if(d){$(a).find("#importValuesTemplateContainer").html(c.uploadedValues);c=$("#importValueModal"+b);c.modal("show");var e=c.find(".invalidValuesContainer");h(a,c);c.find("#showWarnings").on("click",function(){e.attr("hidden")?e.removeAttr("hidden"):e.attr("hidden","hidden")})}else $(a).find(".copyPasteContent").val(c.uploadedValues);
$(a).find(".copyAndPasteModal input:radio[name^=delimiter][value=\\;]").prop("checked",!0);$(a).find(".confirm-paste").show();$(a).find(".import-values").hide()},h=function(a,c){c.off("click.import-values").on("click.import-values",".confirm-import",function(c){c.preventDefault();$(a).find(".copyPasteContent").val(validValues)})};addPencilIcon()});function getIsFromCopyPasteValue(b){return"true"==$(b).find(".isFromCopyPaste").val()}function getCopyPasteIcon(b){return $(b).find(".copy-n-paste")}
function addCopyPasteModal(b,g,h){var a="copyAndPasteModal"+g.replace(".","")+"qev"+h;$(b).find(".copy-n-paste").attr("data-target","#"+a).show();$(b).find("#copyAndPasteModal").attr("id",a);$(b).find("input:radio[id=delimiter_none]").attr("checked","checked");$(b).find("input:radio[name^=delimiter]").attr("name","delimiter"+g.replace(".","")+"qev"+h);var c=$("#"+a);fileChange(c);fileSelect(a);$(c).off("show.bs.modal").on("show.bs.modal",function(){var a=$(this).closest(".toAddContainerQEV")[0],b=
$(a).find(".expressionsNoPad:visible")[0],e=$($(b).find("#selectValue")).val();getFieldIsValidatableFromExpression(a)?c.find(".validate-copy-paste").removeAttr("disabled"):$(".validate-copy-paste").attr("disabled","disabled");void 0==e&&(e="",b=$($(b).find("#selectSelect")).val(),void 0==b&&(b=$($(this).closest(".queryBlankContainer").find("input.expressionValueSelectAuto")[0]).select2("val")),void 0!=b&&($.each(b,function(){e+=this+";"}),e=e.substring(0,e.length-1)));void 0==e||_.isEmpty(e)?$(this).find('input:radio[name^=delimiter][value="none"]').prop("checked",
!0):$(this).find('input:radio[name^=delimiter][value=";"]').prop("checked",!0);$(a).find(".copyPasteContent").val(e)})}
var fileChange=function(b){b.on("change",":file",function(){var g=$(this),h=g.get(0).files?g.get(0).files.length:0,a=g.val().replace(/\\/g,"/").replace(/.*\//,""),c=[".xlsx",".xls"],f=a.substring(a.lastIndexOf("."));0<h?(b.find(".confirm-paste").hide(),b.find(".import-values").show(),0>c.indexOf(f.toLowerCase())?(b.find("#fileFormatError").show(),b.find(".import-values").attr("disabled","disabled")):(b.find("#fileFormatError").hide(),b.find(".import-values").removeAttr("disabled"),$(this).closest(".toAddContainerQEV"))):
(b.find("#fileFormatError").hide(),b.find(".import-values").hide(),b.find(".confirm-paste").show());g.trigger("fileselect",[h,a])})},fileSelect=function(b){$("#"+b+" :file").on("fileselect",function(b,h,a){b=$(this).parents(".input-group").find(":text");b.length&&b.val(0<h?a:"")})},addPencilIcon=function(){$("#eventSelectionDictionary").length&&$("#eventSelectionDictionary >div").children("label").append('<i tbindex="0" class="fa fa-pencil-square-o copy-n-paste modal-link" data-toggle="modal" data-target="#copyAndPasteDicModal"></i>');
$("#productDicIng").length&&$("#productDicIng").append('<i tbindex="0" class="fa fa-pencil-square-o copy-n-paste modal-link" data-toggle="modal" data-target="#copyAndPasteDicModal"></i>');var b=$("label:contains('HLT')").children("i");b.hasClass("hidden")&&b.removeClass("hidden")};