<?xml version="1.0" encoding="utf-8"?>
<HTTPSnapshot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="306">
  <HTTPTask id="3585" hostname="10.100.22.24:8181" path="/signal/assets/plugin/dictionary/polymer-mini.html" url="http://10.100.22.24:8181/signal/assets/plugin/dictionary/polymer-mini.html" ip="10.100.22.24" port="8181" connectionId="14" origin="Primary" frame="1" startDateTime="2020-01-13T12:43:41.306+05:30" startTime="1263732984" endTime="1263733328">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Host" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTAuMTAwLjIyLjI0OjgxODE=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6NzIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC83Mi4w</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ki8q</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZW4tVVMsZW47cT0wLjU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="DNT" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>a2VlcC1hbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cDovLzEwLjEwMC4yMi4yNDo4MTgxL3NpZ25hbC9yZXBvcnQvaW5kZXg=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>U0VTU0lPTj02ODg3MDk2ZC05OGI3LTQxZGMtYmIzYS04ZTMzYzYzMDAzMTM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC9zaWduYWwvYXNzZXRzL3BsdWdpbi9kaWN0aW9uYXJ5L3BvbHltZXItbWluaS5odG1sIEhUVFAvMS4xDQpIb3N0OiAxMC4xMDAuMjIuMjQ6ODE4MQ0KVXNlci1BZ2VudDogTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6NzIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC83Mi4wDQpBY2NlcHQ6ICovKg0KQWNjZXB0LUxhbmd1YWdlOiBlbi1VUyxlbjtxPTAuNQ0KQWNjZXB0LUVuY29kaW5nOiBnemlwLCBkZWZsYXRlDQpETlQ6IDENCkNvbm5lY3Rpb246IGtlZXAtYWxpdmUNClJlZmVyZXI6IGh0dHA6Ly8xMC4xMDAuMjIuMjQ6ODE4MS9zaWduYWwvcmVwb3J0L2luZGV4DQpDb29raWU6IFNFU1NJT049Njg4NzA5NmQtOThiNy00MWRjLWJiM2EtOGUzM2M2MzAwMzEzDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="SESSION" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Njg4NzA5NmQtOThiNy00MWRjLWJiM2EtOGUzM2M2MzAwMzEz</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>8921</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Last-Modified" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>U3VuLCAxMiBKYW4gMjAyMCAwODoxNjowMiBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="ETag" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>InBsdWdpbi9kaWN0aW9uYXJ5L3BvbHltZXItbWluaS0zZGUwMmE1MTNlNDRiMzQ4ZDA3ZjNjNTdhNjI3N2M3MC5odG1sIg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Vary" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>cHVibGljLCBtYXgtYWdlPTMxNTM2MDAw</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Encoding" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>dGV4dC9odG1sO2NoYXJzZXQ9VVRGLTg=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ODkyMQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW9uLCAxMyBKYW4gMjAyMCAwNzowMDoyNyBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIA0KTGFzdC1Nb2RpZmllZDogU3VuLCAxMiBKYW4gMjAyMCAwODoxNjowMiBHTVQNCkVUYWc6ICJwbHVnaW4vZGljdGlvbmFyeS9wb2x5bWVyLW1pbmktM2RlMDJhNTEzZTQ0YjM0OGQwN2YzYzU3YTYyNzdjNzAuaHRtbCINClZhcnk6IEFjY2VwdC1FbmNvZGluZw0KQ2FjaGUtQ29udHJvbDogcHVibGljLCBtYXgtYWdlPTMxNTM2MDAwDQpDb250ZW50LUVuY29kaW5nOiBnemlwDQpDb250ZW50LVR5cGU6IHRleHQvaHRtbDtjaGFyc2V0PVVURi04DQpDb250ZW50LUxlbmd0aDogODkyMQ0KRGF0ZTogTW9uLCAxMyBKYW4gMjAyMCAwNzowMDoyNyBHTVQNCg0K</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>PCEtLQpAbGljZW5zZQpDb3B5cmlnaHQgKGMpIDIwMTQgVGhlIFBvbHltZXIgUHJvamVjdCBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLgpUaGlzIGNvZGUgbWF5IG9ubHkgYmUgdXNlZCB1bmRlciB0aGUgQlNEIHN0eWxlIGxpY2Vuc2UgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0xJQ0VOU0UudHh0ClRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0FVVEhPUlMudHh0ClRoZSBjb21wbGV0ZSBzZXQgb2YgY29udHJpYnV0b3JzIG1heSBiZSBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQ09OVFJJQlVUT1JTLnR4dApDb2RlIGRpc3RyaWJ1dGVkIGJ5IEdvb2dsZSBhcyBwYXJ0IG9mIHRoZSBwb2x5bWVyIHByb2plY3QgaXMgYWxzbwpzdWJqZWN0IHRvIGFuIGFkZGl0aW9uYWwgSVAgcmlnaHRzIGdyYW50IGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dAotLT48bGluayByZWw9ImltcG9ydCIgaHJlZj0icG9seW1lci1taWNyby5odG1sIj4KCjxzY3JpcHQ+UG9seW1lci5CYXNlLl9hZGRGZWF0dXJlKHsKX3ByZXBUZW1wbGF0ZTogZnVuY3Rpb24gKCkgewp0aGlzLl90ZW1wbGF0ZSA9IHRoaXMuX3RlbXBsYXRlIHx8IFBvbHltZXIuRG9tTW9kdWxlLmltcG9ydCh0aGlzLmlzLCAndGVtcGxhdGUnKTsKaWYgKHRoaXMuX3RlbXBsYXRlICYmIHRoaXMuX3RlbXBsYXRlLmhhc0F0dHJpYnV0ZSgnaXMnKSkgewp0aGlzLl93YXJuKHRoaXMuX2xvZ2YoJ19wcmVwVGVtcGxhdGUnLCAndG9wLWxldmVsIFBvbHltZXIgdGVtcGxhdGUgJyArICdtdXN0IG5vdCBiZSBhIHR5cGUtZXh0ZW5zaW9uLCBmb3VuZCcsIHRoaXMuX3RlbXBsYXRlLCAnTW92ZSBpbnNpZGUgc2ltcGxlIDx0ZW1wbGF0ZT4uJykpOwp9CmlmICh0aGlzLl90ZW1wbGF0ZSAmJiAhdGhpcy5fdGVtcGxhdGUuY29udGVudCAmJiBIVE1MVGVtcGxhdGVFbGVtZW50LmJvb3RzdHJhcCkgewpIVE1MVGVtcGxhdGVFbGVtZW50LmRlY29yYXRlKHRoaXMuX3RlbXBsYXRlKTsKSFRNTFRlbXBsYXRlRWxlbWVudC5ib290c3RyYXAodGhpcy5fdGVtcGxhdGUuY29udGVudCk7Cn0KfSwKX3N0YW1wVGVtcGxhdGU6IGZ1bmN0aW9uICgpIHsKaWYgKHRoaXMuX3RlbXBsYXRlKSB7CnRoaXMucm9vdCA9IHRoaXMuaW5zdGFuY2VUZW1wbGF0ZSh0aGlzLl90ZW1wbGF0ZSk7Cn0KfSwKaW5zdGFuY2VUZW1wbGF0ZTogZnVuY3Rpb24gKHRlbXBsYXRlKSB7CnZhciBkb20gPSBkb2N1bWVudC5pbXBvcnROb2RlKHRlbXBsYXRlLl9jb250ZW50IHx8IHRlbXBsYXRlLmNvbnRlbnQsIHRydWUpOwpyZXR1cm4gZG9tOwp9Cn0pOwooZnVuY3Rpb24gKCkgewp2YXIgYmFzZUF0dGFjaGVkQ2FsbGJhY2sgPSBQb2x5bWVyLkJhc2UuYXR0YWNoZWRDYWxsYmFjazsKUG9seW1lci5CYXNlLl9hZGRGZWF0dXJlKHsKX2hvc3RTdGFjazogW10sCnJlYWR5OiBmdW5jdGlvbiAoKSB7Cn0sCl9wdXNoSG9zdDogZnVuY3Rpb24gKGhvc3QpIHsKdGhpcy5kYXRhSG9zdCA9IGhvc3QgPSBob3N0IHx8IFBvbHltZXIuQmFzZS5faG9zdFN0YWNrW1BvbHltZXIuQmFzZS5faG9zdFN0YWNrLmxlbmd0aCAtIDFdOwppZiAoaG9zdCAmJiBob3N0Ll9jbGllbnRzKSB7Cmhvc3QuX2NsaWVudHMucHVzaCh0aGlzKTsKfQp0aGlzLl9iZWdpbkhvc3QoKTsKfSwKX2JlZ2luSG9zdDogZnVuY3Rpb24gKCkgewpQb2x5bWVyLkJhc2UuX2hvc3RTdGFjay5wdXNoKHRoaXMpOwppZiAoIXRoaXMuX2NsaWVudHMpIHsKdGhpcy5fY2xpZW50cyA9IFtdOwp9Cn0sCl9wb3BIb3N0OiBmdW5jdGlvbiAoKSB7ClBvbHltZXIuQmFzZS5faG9zdFN0YWNrLnBvcCgpOwp9LApfdHJ5UmVhZHk6IGZ1bmN0aW9uICgpIHsKaWYgKHRoaXMuX2NhblJlYWR5KCkpIHsKdGhpcy5fcmVhZHkoKTsKfQp9LApfY2FuUmVhZHk6IGZ1bmN0aW9uICgpIHsKcmV0dXJuICF0aGlzLmRhdGFIb3N0IHx8IHRoaXMuZGF0YUhvc3QuX2NsaWVudHNSZWFkaWVkOwp9LApfcmVhZHk6IGZ1bmN0aW9uICgpIHsKdGhpcy5fYmVmb3JlQ2xpZW50c1JlYWR5KCk7CnRoaXMuX3NldHVwUm9vdCgpOwp0aGlzLl9yZWFkeUNsaWVudHMoKTsKdGhpcy5fYWZ0ZXJDbGllbnRzUmVhZHkoKTsKdGhpcy5fcmVhZHlTZWxmKCk7Cn0sCl9yZWFkeUNsaWVudHM6IGZ1bmN0aW9uICgpIHsKdGhpcy5fYmVnaW5EaXN0cmlidXRlKCk7CnZhciBjJCA9IHRoaXMuX2NsaWVudHM7CmZvciAodmFyIGkgPSAwLCBsID0gYyQubGVuZ3RoLCBjOyBpIDwgbCAmJiAoYyA9IGMkW2ldKTsgaSsrKSB7CmMuX3JlYWR5KCk7Cn0KdGhpcy5fZmluaXNoRGlzdHJpYnV0ZSgpOwp0aGlzLl9jbGllbnRzUmVhZGllZCA9IHRydWU7CnRoaXMuX2NsaWVudHMgPSBudWxsOwp9LApfcmVhZHlTZWxmOiBmdW5jdGlvbiAoKSB7CnRoaXMuX2RvQmVoYXZpb3IoJ3JlYWR5Jyk7CnRoaXMuX3JlYWRpZWQgPSB0cnVlOwppZiAodGhpcy5fYXR0YWNoZWRQZW5kaW5nKSB7CnRoaXMuX2F0dGFjaGVkUGVuZGluZyA9IGZhbHNlOwp0aGlzLmF0dGFjaGVkQ2FsbGJhY2soKTsKfQp9LApfYmVmb3JlQ2xpZW50c1JlYWR5OiBmdW5jdGlvbiAoKSB7Cn0sCl9hZnRlckNsaWVudHNSZWFkeTogZnVuY3Rpb24gKCkgewp9LApfYmVmb3JlQXR0YWNoZWQ6IGZ1bmN0aW9uICgpIHsKfSwKYXR0YWNoZWRDYWxsYmFjazogZnVuY3Rpb24gKCkgewppZiAodGhpcy5fcmVhZGllZCkgewp0aGlzLl9iZWZvcmVBdHRhY2hlZCgpOwpiYXNlQXR0YWNoZWRDYWxsYmFjay5jYWxsKHRoaXMpOwp9IGVsc2Ugewp0aGlzLl9hdHRhY2hlZFBlbmRpbmcgPSB0cnVlOwp9Cn0KfSk7Cn0oKSk7ClBvbHltZXIuQXJyYXlTcGxpY2UgPSBmdW5jdGlvbiAoKSB7CmZ1bmN0aW9uIG5ld1NwbGljZShpbmRleCwgcmVtb3ZlZCwgYWRkZWRDb3VudCkgewpyZXR1cm4gewppbmRleDogaW5kZXgsCnJlbW92ZWQ6IHJlbW92ZWQsCmFkZGVkQ291bnQ6IGFkZGVkQ291bnQKfTsKfQp2YXIgRURJVF9MRUFWRSA9IDA7CnZhciBFRElUX1VQREFURSA9IDE7CnZhciBFRElUX0FERCA9IDI7CnZhciBFRElUX0RFTEVURSA9IDM7CmZ1bmN0aW9uIEFycmF5U3BsaWNlKCkgewp9CkFycmF5U3BsaWNlLnByb3RvdHlwZSA9IHsKY2FsY0VkaXREaXN0YW5jZXM6IGZ1bmN0aW9uIChjdXJyZW50LCBjdXJyZW50U3RhcnQsIGN1cnJlbnRFbmQsIG9sZCwgb2xkU3RhcnQsIG9sZEVuZCkgewp2YXIgcm93Q291bnQgPSBvbGRFbmQgLSBvbGRTdGFydCArIDE7CnZhciBjb2x1bW5Db3VudCA9IGN1cnJlbnRFbmQgLSBjdXJyZW50U3RhcnQgKyAxOwp2YXIgZGlzdGFuY2VzID0gbmV3IEFycmF5KHJvd0NvdW50KTsKZm9yICh2YXIgaSA9IDA7IGkgPCByb3dDb3VudDsgaSsrKSB7CmRpc3RhbmNlc1tpXSA9IG5ldyBBcnJheShjb2x1bW5Db3VudCk7CmRpc3RhbmNlc1tpXVswXSA9IGk7Cn0KZm9yICh2YXIgaiA9IDA7IGogPCBjb2x1bW5Db3VudDsgaisrKQpkaXN0YW5jZXNbMF1bal0gPSBqOwpmb3IgKHZhciBpID0gMTsgaSA8IHJvd0NvdW50OyBpKyspIHsKZm9yICh2YXIgaiA9IDE7IGogPCBjb2x1bW5Db3VudDsgaisrKSB7CmlmICh0aGlzLmVxdWFscyhjdXJyZW50W2N1cnJlbnRTdGFydCArIGogLSAxXSwgb2xkW29sZFN0YXJ0ICsgaSAtIDFdKSkKZGlzdGFuY2VzW2ldW2pdID0gZGlzdGFuY2VzW2kgLSAxXVtqIC0gMV07CmVsc2Ugewp2YXIgbm9ydGggPSBkaXN0YW5jZXNbaSAtIDFdW2pdICsgMTsKdmFyIHdlc3QgPSBkaXN0YW5jZXNbaV1baiAtIDFdICsgMTsKZGlzdGFuY2VzW2ldW2pdID0gbm9ydGggPCB3ZXN0ID8gbm9ydGggOiB3ZXN0Owp9Cn0KfQpyZXR1cm4gZGlzdGFuY2VzOwp9LApzcGxpY2VPcGVyYXRpb25zRnJvbUVkaXREaXN0YW5jZXM6IGZ1bmN0aW9uIChkaXN0YW5jZXMpIHsKdmFyIGkgPSBkaXN0YW5jZXMubGVuZ3RoIC0gMTsKdmFyIGogPSBkaXN0YW5jZXNbMF0ubGVuZ3RoIC0gMTsKdmFyIGN1cnJlbnQgPSBkaXN0YW5jZXNbaV1bal07CnZhciBlZGl0cyA9IFtdOwp3aGlsZSAoaSA+IDAgfHwgaiA+IDApIHsKaWYgKGkgPT0gMCkgewplZGl0cy5wdXNoKEVESVRfQUREKTsKai0tOwpjb250aW51ZTsKfQppZiAoaiA9PSAwKSB7CmVkaXRzLnB1c2goRURJVF9ERUxFVEUpOwppLS07CmNvbnRpbnVlOwp9CnZhciBub3J0aFdlc3QgPSBkaXN0YW5jZXNbaSAtIDFdW2ogLSAxXTsKdmFyIHdlc3QgPSBkaXN0YW5jZXNbaSAtIDFdW2pdOwp2YXIgbm9ydGggPSBkaXN0YW5jZXNbaV1baiAtIDFdOwp2YXIgbWluOwppZiAod2VzdCA8IG5vcnRoKQptaW4gPSB3ZXN0IDwgbm9ydGhXZXN0ID8gd2VzdCA6IG5vcnRoV2VzdDsKZWxzZQptaW4gPSBub3J0aCA8IG5vcnRoV2VzdCA/IG5vcnRoIDogbm9ydGhXZXN0OwppZiAobWluID09IG5vcnRoV2VzdCkgewppZiAobm9ydGhXZXN0ID09IGN1cnJlbnQpIHsKZWRpdHMucHVzaChFRElUX0xFQVZFKTsKfSBlbHNlIHsKZWRpdHMucHVzaChFRElUX1VQREFURSk7CmN1cnJlbnQgPSBub3J0aFdlc3Q7Cn0KaS0tOwpqLS07Cn0gZWxzZSBpZiAobWluID09IHdlc3QpIHsKZWRpdHMucHVzaChFRElUX0RFTEVURSk7CmktLTsKY3VycmVudCA9IHdlc3Q7Cn0gZWxzZSB7CmVkaXRzLnB1c2goRURJVF9BREQpOwpqLS07CmN1cnJlbnQgPSBub3J0aDsKfQp9CmVkaXRzLnJldmVyc2UoKTsKcmV0dXJuIGVkaXRzOwp9LApjYWxjU3BsaWNlczogZnVuY3Rpb24gKGN1cnJlbnQsIGN1cnJlbnRTdGFydCwgY3VycmVudEVuZCwgb2xkLCBvbGRTdGFydCwgb2xkRW5kKSB7CnZhciBwcmVmaXhDb3VudCA9IDA7CnZhciBzdWZmaXhDb3VudCA9IDA7CnZhciBtaW5MZW5ndGggPSBNYXRoLm1pbihjdXJyZW50RW5kIC0gY3VycmVudFN0YXJ0LCBvbGRFbmQgLSBvbGRTdGFydCk7CmlmIChjdXJyZW50U3RhcnQgPT0gMCAmJiBvbGRTdGFydCA9PSAwKQpwcmVmaXhDb3VudCA9IHRoaXMuc2hhcmVkUHJlZml4KGN1cnJlbnQsIG9sZCwgbWluTGVuZ3RoKTsKaWYgKGN1cnJlbnRFbmQgPT0gY3VycmVudC5sZW5ndGggJiYgb2xkRW5kID09IG9sZC5sZW5ndGgpCnN1ZmZpeENvdW50ID0gdGhpcy5zaGFyZWRTdWZmaXgoY3VycmVudCwgb2xkLCBtaW5MZW5ndGggLSBwcmVmaXhDb3VudCk7CmN1cnJlbnRTdGFydCArPSBwcmVmaXhDb3VudDsKb2xkU3RhcnQgKz0gcHJlZml4Q291bnQ7CmN1cnJlbnRFbmQgLT0gc3VmZml4Q291bnQ7Cm9sZEVuZCAtPSBzdWZmaXhDb3VudDsKaWYgKGN1cnJlbnRFbmQgLSBjdXJyZW50U3RhcnQgPT0gMCAmJiBvbGRFbmQgLSBvbGRTdGFydCA9PSAwKQpyZXR1cm4gW107CmlmIChjdXJyZW50U3RhcnQgPT0gY3VycmVudEVuZCkgewp2YXIgc3BsaWNlID0gbmV3U3BsaWNlKGN1cnJlbnRTdGFydCwgW10sIDApOwp3aGlsZSAob2xkU3RhcnQgPCBvbGRFbmQpCnNwbGljZS5yZW1vdmVkLnB1c2gob2xkW29sZFN0YXJ0KytdKTsKcmV0dXJuIFtzcGxpY2VdOwp9IGVsc2UgaWYgKG9sZFN0YXJ0ID09IG9sZEVuZCkKcmV0dXJuIFtuZXdTcGxpY2UoY3VycmVudFN0YXJ0LCBbXSwgY3VycmVudEVuZCAtIGN1cnJlbnRTdGFydCldOwp2YXIgb3BzID0gdGhpcy5zcGxpY2VPcGVyYXRpb25zRnJvbUVkaXREaXN0YW5jZXModGhpcy5jYWxjRWRpdERpc3RhbmNlcyhjdXJyZW50LCBjdXJyZW50U3RhcnQsIGN1cnJlbnRFbmQsIG9sZCwgb2xkU3RhcnQsIG9sZEVuZCkpOwp2YXIgc3BsaWNlID0gdW5kZWZpbmVkOwp2YXIgc3BsaWNlcyA9IFtdOwp2YXIgaW5kZXggPSBjdXJyZW50U3RhcnQ7CnZhciBvbGRJbmRleCA9IG9sZFN0YXJ0Owpmb3IgKHZhciBpID0gMDsgaSA8IG9wcy5sZW5ndGg7IGkrKykgewpzd2l0Y2ggKG9wc1tpXSkgewpjYXNlIEVESVRfTEVBVkU6CmlmIChzcGxpY2UpIHsKc3BsaWNlcy5wdXNoKHNwbGljZSk7CnNwbGljZSA9IHVuZGVmaW5lZDsKfQppbmRleCsrOwpvbGRJbmRleCsrOwpicmVhazsKY2FzZSBFRElUX1VQREFURToKaWYgKCFzcGxpY2UpCnNwbGljZSA9IG5ld1NwbGljZShpbmRleCwgW10sIDApOwpzcGxpY2UuYWRkZWRDb3VudCsrOwppbmRleCsrOwpzcGxpY2UucmVtb3ZlZC5wdXNoKG9sZFtvbGRJbmRleF0pOwpvbGRJbmRleCsrOwpicmVhazsKY2FzZSBFRElUX0FERDoKaWYgKCFzcGxpY2UpCnNwbGljZSA9IG5ld1NwbGljZShpbmRleCwgW10sIDApOwpzcGxpY2UuYWRkZWRDb3VudCsrOwppbmRleCsrOwpicmVhazsKY2FzZSBFRElUX0RFTEVURToKaWYgKCFzcGxpY2UpCnNwbGljZSA9IG5ld1NwbGljZShpbmRleCwgW10sIDApOwpzcGxpY2UucmVtb3ZlZC5wdXNoKG9sZFtvbGRJbmRleF0pOwpvbGRJbmRleCsrOwpicmVhazsKfQp9CmlmIChzcGxpY2UpIHsKc3BsaWNlcy5wdXNoKHNwbGljZSk7Cn0KcmV0dXJuIHNwbGljZXM7Cn0sCnNoYXJlZFByZWZpeDogZnVuY3Rpb24gKGN1cnJlbnQsIG9sZCwgc2VhcmNoTGVuZ3RoKSB7CmZvciAodmFyIGkgPSAwOyBpIDwgc2VhcmNoTGVuZ3RoOyBpKyspCmlmICghdGhpcy5lcXVhbHMoY3VycmVudFtpXSwgb2xkW2ldKSkKcmV0dXJuIGk7CnJldHVybiBzZWFyY2hMZW5ndGg7Cn0sCnNoYXJlZFN1ZmZpeDogZnVuY3Rpb24gKGN1cnJlbnQsIG9sZCwgc2VhcmNoTGVuZ3RoKSB7CnZhciBpbmRleDEgPSBjdXJyZW50Lmxlbmd0aDsKdmFyIGluZGV4MiA9IG9sZC5sZW5ndGg7CnZhciBjb3VudCA9IDA7CndoaWxlIChjb3VudCA8IHNlYXJjaExlbmd0aCAmJiB0aGlzLmVxdWFscyhjdXJyZW50Wy0taW5kZXgxXSwgb2xkWy0taW5kZXgyXSkpCmNvdW50Kys7CnJldHVybiBjb3VudDsKfSwKY2FsY3VsYXRlU3BsaWNlczogZnVuY3Rpb24gKGN1cnJlbnQsIHByZXZpb3VzKSB7CnJldHVybiB0aGlzLmNhbGNTcGxpY2VzKGN1cnJlbnQsIDAsIGN1cnJlbnQubGVuZ3RoLCBwcmV2aW91cywgMCwgcHJldmlvdXMubGVuZ3RoKTsKfSwKZXF1YWxzOiBmdW5jdGlvbiAoY3VycmVudFZhbHVlLCBwcmV2aW91c1ZhbHVlKSB7CnJldHVybiBjdXJyZW50VmFsdWUgPT09IHByZXZpb3VzVmFsdWU7Cn0KfTsKcmV0dXJuIG5ldyBBcnJheVNwbGljZSgpOwp9KCk7ClBvbHltZXIuRXZlbnRBcGkgPSBmdW5jdGlvbiAoKSB7CnZhciBTZXR0aW5ncyA9IFBvbHltZXIuU2V0dGluZ3M7CnZhciBFdmVudEFwaSA9IGZ1bmN0aW9uIChldmVudCkgewp0aGlzLmV2ZW50ID0gZXZlbnQ7Cn07CmlmIChTZXR0aW5ncy51c2VTaGFkb3cpIHsKRXZlbnRBcGkucHJvdG90eXBlID0gewpnZXQgcm9vdFRhcmdldCgpIHsKcmV0dXJuIHRoaXMuZXZlbnQucGF0aFswXTsKfSwKZ2V0IGxvY2FsVGFyZ2V0KCkgewpyZXR1cm4gdGhpcy5ldmVudC50YXJnZXQ7Cn0sCmdldCBwYXRoKCkgewpyZXR1cm4gdGhpcy5ldmVudC5wYXRoOwp9Cn07Cn0gZWxzZSB7CkV2ZW50QXBpLnByb3RvdHlwZSA9IHsKZ2V0IHJvb3RUYXJnZXQoKSB7CnJldHVybiB0aGlzLmV2ZW50LnRhcmdldDsKfSwKZ2V0IGxvY2FsVGFyZ2V0KCkgewp2YXIgY3VycmVudCA9IHRoaXMuZXZlbnQuY3VycmVudFRhcmdldDsKdmFyIGN1cnJlbnRSb290ID0gY3VycmVudCAmJiBQb2x5bWVyLmRvbShjdXJyZW50KS5nZXRPd25lclJvb3QoKTsKdmFyIHAkID0gdGhpcy5wYXRoOwpmb3IgKHZhciBpID0gMDsgaSA8IHAkLmxlbmd0aDsgaSsrKSB7CmlmIChQb2x5bWVyLmRvbShwJFtpXSkuZ2V0T3duZXJSb290KCkgPT09IGN1cnJlbnRSb290KSB7CnJldHVybiBwJFtpXTsKfQp9Cn0sCmdldCBwYXRoKCkgewppZiAoIXRoaXMuZXZlbnQuX3BhdGgpIHsKdmFyIHBhdGggPSBbXTsKdmFyIG8gPSB0aGlzLnJvb3RUYXJnZXQ7CndoaWxlIChvKSB7CnBhdGgucHVzaChvKTsKbyA9IFBvbHltZXIuZG9tKG8pLnBhcmVudE5vZGUgfHwgby5ob3N0Owp9CnBhdGgucHVzaCh3aW5kb3cpOwp0aGlzLmV2ZW50Ll9wYXRoID0gcGF0aDsKfQpyZXR1cm4gdGhpcy5ldmVudC5fcGF0aDsKfQp9Owp9CnZhciBmYWN0b3J5ID0gZnVuY3Rpb24gKGV2ZW50KSB7CmlmICghZXZlbnQuX19ldmVudEFwaSkgewpldmVudC5fX2V2ZW50QXBpID0gbmV3IEV2ZW50QXBpKGV2ZW50KTsKfQpyZXR1cm4gZXZlbnQuX19ldmVudEFwaTsKfTsKcmV0dXJuIHsgZmFjdG9yeTogZmFjdG9yeSB9Owp9KCk7ClBvbHltZXIuZG9tSW5uZXJIVE1MID0gZnVuY3Rpb24gKCkgewp2YXIgZXNjYXBlQXR0clJlZ0V4cCA9IC9bJlx1MDBBMCJdL2c7CnZhciBlc2NhcGVEYXRhUmVnRXhwID0gL1smXHUwMEEwPD5dL2c7CmZ1bmN0aW9uIGVzY2FwZVJlcGxhY2UoYykgewpzd2l0Y2ggKGMpIHsKY2FzZSAnJic6CnJldHVybiAnJmFtcDsnOwpjYXNlICc8JzoKcmV0dXJuICcmbHQ7JzsKY2FzZSAnPic6CnJldHVybiAnJmd0Oyc7CmNhc2UgJyInOgpyZXR1cm4gJyZxdW90Oyc7CmNhc2UgJ1x4QTAnOgpyZXR1cm4gJyZuYnNwOyc7Cn0KfQpmdW5jdGlvbiBlc2NhcGVBdHRyKHMpIHsKcmV0dXJuIHMucmVwbGFjZShlc2NhcGVBdHRyUmVnRXhwLCBlc2NhcGVSZXBsYWNlKTsKfQpmdW5jdGlvbiBlc2NhcGVEYXRhKHMpIHsKcmV0dXJuIHMucmVwbGFjZShlc2NhcGVEYXRhUmVnRXhwLCBlc2NhcGVSZXBsYWNlKTsKfQpmdW5jdGlvbiBtYWtlU2V0KGFycikgewp2YXIgc2V0ID0ge307CmZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CnNldFthcnJbaV1dID0gdHJ1ZTsKfQpyZXR1cm4gc2V0Owp9CnZhciB2b2lkRWxlbWVudHMgPSBtYWtlU2V0KFsKJ2FyZWEnLAonYmFzZScsCidicicsCidjb2wnLAonY29tbWFuZCcsCidlbWJlZCcsCidocicsCidpbWcnLAonaW5wdXQnLAona2V5Z2VuJywKJ2xpbmsnLAonbWV0YScsCidwYXJhbScsCidzb3VyY2UnLAondHJhY2snLAond2JyJwpdKTsKdmFyIHBsYWludGV4dFBhcmVudHMgPSBtYWtlU2V0KFsKJ3N0eWxlJywKJ3NjcmlwdCcsCid4bXAnLAonaWZyYW1lJywKJ25vZW1iZWQnLAonbm9mcmFtZXMnLAoncGxhaW50ZXh0JywKJ25vc2NyaXB0JwpdKTsKZnVuY3Rpb24gZ2V0T3V0ZXJIVE1MKG5vZGUsIHBhcmVudE5vZGUsIGNvbXBvc2VkKSB7CnN3aXRjaCAobm9kZS5ub2RlVHlwZSkgewpjYXNlIE5vZGUuRUxFTUVOVF9OT0RFOgp2YXIgdGFnTmFtZSA9IG5vZGUubG9jYWxOYW1lOwp2YXIgcyA9ICc8JyArIHRhZ05hbWU7CnZhciBhdHRycyA9IG5vZGUuYXR0cmlidXRlczsKZm9yICh2YXIgaSA9IDAsIGF0dHI7IGF0dHIgPSBhdHRyc1tpXTsgaSsrKSB7CnMgKz0gJyAnICsgYXR0ci5uYW1lICsgJz0iJyArIGVzY2FwZUF0dHIoYXR0ci52YWx1ZSkgKyAnIic7Cn0KcyArPSAnPic7CmlmICh2b2lkRWxlbWVudHNbdGFnTmFtZV0pIHsKcmV0dXJuIHM7Cn0KcmV0dXJuIHMgKyBnZXRJbm5lckhUTUwobm9kZSwgY29tcG9zZWQpICsgJzwvJyArIHRhZ05hbWUgKyAnPic7CmNhc2UgTm9kZS5URVhUX05PREU6CnZhciBkYXRhID0gbm9kZS5kYXRhOwppZiAocGFyZW50Tm9kZSAmJiBwbGFpbnRleHRQYXJlbnRzW3BhcmVudE5vZGUubG9jYWxOYW1lXSkgewpyZXR1cm4gZGF0YTsKfQpyZXR1cm4gZXNjYXBlRGF0YShkYXRhKTsKY2FzZSBOb2RlLkNPTU1FTlRfTk9ERToKcmV0dXJuICc8IS0tJyArIG5vZGUuZGF0YSArICctLT4nOwpkZWZhdWx0Ogpjb25zb2xlLmVycm9yKG5vZGUpOwp0aHJvdyBuZXcgRXJyb3IoJ25vdCBpbXBsZW1lbnRlZCcpOwp9Cn0KZnVuY3Rpb24gZ2V0SW5uZXJIVE1MKG5vZGUsIGNvbXBvc2VkKSB7CmlmIChub2RlIGluc3RhbmNlb2YgSFRNTFRlbXBsYXRlRWxlbWVudCkKbm9kZSA9IG5vZGUuY29udGVudDsKdmFyIHMgPSAnJzsKdmFyIGMkID0gUG9seW1lci5kb20obm9kZSkuY2hpbGROb2RlczsKYyQgPSBjb21wb3NlZCA/IG5vZGUuX2NvbXBvc2VkQ2hpbGRyZW4gOiBjJDsKZm9yICh2YXIgaSA9IDAsIGwgPSBjJC5sZW5ndGgsIGNoaWxkOyBpIDwgbCAmJiAoY2hpbGQgPSBjJFtpXSk7IGkrKykgewpzICs9IGdldE91dGVySFRNTChjaGlsZCwgbm9kZSwgY29tcG9zZWQpOwp9CnJldHVybiBzOwp9CnJldHVybiB7IGdldElubmVySFRNTDogZ2V0SW5uZXJIVE1MIH07Cn0oKTsKUG9seW1lci5Eb21BcGkgPSBmdW5jdGlvbiAoKSB7Cid1c2Ugc3RyaWN0JzsKdmFyIFNldHRpbmdzID0gUG9seW1lci5TZXR0aW5nczsKdmFyIGdldElubmVySFRNTCA9IFBvbHltZXIuZG9tSW5uZXJIVE1MLmdldElubmVySFRNTDsKdmFyIG5hdGl2ZUluc2VydEJlZm9yZSA9IEVsZW1lbnQucHJvdG90eXBlLmluc2VydEJlZm9yZTsKdmFyIG5hdGl2ZVJlbW92ZUNoaWxkID0gRWxlbWVudC5wcm90b3R5cGUucmVtb3ZlQ2hpbGQ7CnZhciBuYXRpdmVBcHBlbmRDaGlsZCA9IEVsZW1lbnQucHJvdG90eXBlLmFwcGVuZENoaWxkOwp2YXIgbmF0aXZlQ2xvbmVOb2RlID0gRWxlbWVudC5wcm90b3R5cGUuY2xvbmVOb2RlOwp2YXIgbmF0aXZlSW1wb3J0Tm9kZSA9IERvY3VtZW50LnByb3RvdHlwZS5pbXBvcnROb2RlOwp2YXIgRG9tQXBpID0gZnVuY3Rpb24gKG5vZGUpIHsKdGhpcy5ub2RlID0gbm9kZTsKaWYgKHRoaXMucGF0Y2gpIHsKdGhpcy5wYXRjaCgpOwp9Cn07CmlmICh3aW5kb3cud3JhcCAmJiBTZXR0aW5ncy51c2VTaGFkb3cgJiYgIVNldHRpbmdzLnVzZU5hdGl2ZVNoYWRvdykgewpEb21BcGkgPSBmdW5jdGlvbiAobm9kZSkgewp0aGlzLm5vZGUgPSB3cmFwKG5vZGUpOwppZiAodGhpcy5wYXRjaCkgewp0aGlzLnBhdGNoKCk7Cn0KfTsKfQpEb21BcGkucHJvdG90eXBlID0gewpmbHVzaDogZnVuY3Rpb24gKCkgewpQb2x5bWVyLmRvbS5mbHVzaCgpOwp9LApfbGF6eURpc3RyaWJ1dGU6IGZ1bmN0aW9uIChob3N0KSB7CmlmIChob3N0LnNoYWR5Um9vdCAmJiBob3N0LnNoYWR5Um9vdC5fZGlzdHJpYnV0aW9uQ2xlYW4pIHsKaG9zdC5zaGFkeVJvb3QuX2Rpc3RyaWJ1dGlvbkNsZWFuID0gZmFsc2U7ClBvbHltZXIuZG9tLmFkZERlYm91bmNlcihob3N0LmRlYm91bmNlKCdfZGlzdHJpYnV0ZScsIGhvc3QuX2Rpc3RyaWJ1dGVDb250ZW50KSk7Cn0KfSwKYXBwZW5kQ2hpbGQ6IGZ1bmN0aW9uIChub2RlKSB7CnJldHVybiB0aGlzLl9hZGROb2RlKG5vZGUpOwp9LAppbnNlcnRCZWZvcmU6IGZ1bmN0aW9uIChub2RlLCByZWZfbm9kZSkgewpyZXR1cm4gdGhpcy5fYWRkTm9kZShub2RlLCByZWZfbm9kZSk7Cn0sCl9hZGROb2RlOiBmdW5jdGlvbiAobm9kZSwgcmVmX25vZGUpIHsKdGhpcy5fcmVtb3ZlTm9kZUZyb21Ib3N0KG5vZGUsIHRydWUpOwp2YXIgYWRkZWRJbnNlcnRpb25Qb2ludDsKdmFyIHJvb3QgPSB0aGlzLmdldE93bmVyUm9vdCgpOwppZiAocm9vdCkgewphZGRlZEluc2VydGlvblBvaW50ID0gdGhpcy5fbWF5YmVBZGRJbnNlcnRpb25Qb2ludChub2RlLCB0aGlzLm5vZGUpOwp9CmlmICh0aGlzLl9ub2RlSGFzTG9naWNhbENoaWxkcmVuKHRoaXMubm9kZSkpIHsKaWYgKHJlZl9ub2RlKSB7CnZhciBjaGlsZHJlbiA9IHRoaXMuY2hpbGROb2RlczsKdmFyIGluZGV4ID0gY2hpbGRyZW4uaW5kZXhPZihyZWZfbm9kZSk7CmlmIChpbmRleCA8IDApIHsKdGhyb3cgRXJyb3IoJ1RoZSByZWZfbm9kZSB0byBiZSBpbnNlcnRlZCBiZWZvcmUgaXMgbm90IGEgY2hpbGQgJyArICdvZiB0aGlzIG5vZGUnKTsKfQp9CnRoaXMuX2FkZExvZ2ljYWxJbmZvKG5vZGUsIHRoaXMubm9kZSwgaW5kZXgpOwp9CnRoaXMuX2FkZE5vZGVUb0hvc3Qobm9kZSk7CmlmICghdGhpcy5fbWF5YmVEaXN0cmlidXRlKG5vZGUsIHRoaXMubm9kZSkgJiYgIXRoaXMuX3RyeVJlbW92ZVVuZGlzdHJpYnV0ZWROb2RlKG5vZGUpKSB7CmlmIChyZWZfbm9kZSkgewpyZWZfbm9kZSA9IHJlZl9ub2RlLmxvY2FsTmFtZSA9PT0gQ09OVEVOVCA/IHRoaXMuX2ZpcnN0Q29tcG9zZWROb2RlKHJlZl9ub2RlKSA6IHJlZl9ub2RlOwp9CnZhciBjb250YWluZXIgPSB0aGlzLm5vZGUuX2lzU2hhZHlSb290ID8gdGhpcy5ub2RlLmhvc3QgOiB0aGlzLm5vZGU7CmFkZFRvQ29tcG9zZWRQYXJlbnQoY29udGFpbmVyLCBub2RlLCByZWZfbm9kZSk7CmlmIChyZWZfbm9kZSkgewpuYXRpdmVJbnNlcnRCZWZvcmUuY2FsbChjb250YWluZXIsIG5vZGUsIHJlZl9ub2RlKTsKfSBlbHNlIHsKbmF0aXZlQXBwZW5kQ2hpbGQuY2FsbChjb250YWluZXIsIG5vZGUpOwp9Cn0KaWYgKGFkZGVkSW5zZXJ0aW9uUG9pbnQpIHsKdGhpcy5fdXBkYXRlSW5zZXJ0aW9uUG9pbnRzKHJvb3QuaG9zdCk7Cn0KcmV0dXJuIG5vZGU7Cn0sCnJlbW92ZUNoaWxkOiBmdW5jdGlvbiAobm9kZSkgewppZiAoZmFjdG9yeShub2RlKS5wYXJlbnROb2RlICE9PSB0aGlzLm5vZGUpIHsKY29uc29sZS53YXJuKCdUaGUgbm9kZSB0byBiZSByZW1vdmVkIGlzIG5vdCBhIGNoaWxkIG9mIHRoaXMgbm9kZScsIG5vZGUpOwp9CnRoaXMuX3JlbW92ZU5vZGVGcm9tSG9zdChub2RlKTsKaWYgKCF0aGlzLl9tYXliZURpc3RyaWJ1dGUobm9kZSwgdGhpcy5ub2RlKSkgewp2YXIgY29udGFpbmVyID0gdGhpcy5ub2RlLl9pc1NoYWR5Um9vdCA/IHRoaXMubm9kZS5ob3N0IDogdGhpcy5ub2RlOwppZiAoY29udGFpbmVyID09PSBub2RlLnBhcmVudE5vZGUpIHsKcmVtb3ZlRnJvbUNvbXBvc2VkUGFyZW50KGNvbnRhaW5lciwgbm9kZSk7Cm5hdGl2ZVJlbW92ZUNoaWxkLmNhbGwoY29udGFpbmVyLCBub2RlKTsKfQp9CnJldHVybiBub2RlOwp9LApyZXBsYWNlQ2hpbGQ6IGZ1bmN0aW9uIChub2RlLCByZWZfbm9kZSkgewp0aGlzLmluc2VydEJlZm9yZShub2RlLCByZWZfbm9kZSk7CnRoaXMucmVtb3ZlQ2hpbGQocmVmX25vZGUpOwpyZXR1cm4gbm9kZTsKfSwKX2hhc0NhY2hlZE93bmVyUm9vdDogZnVuY3Rpb24gKG5vZGUpIHsKcmV0dXJuIEJvb2xlYW4obm9kZS5fb3duZXJTaGFkeVJvb3QgIT09IHVuZGVmaW5lZCk7Cn0sCmdldE93bmVyUm9vdDogZnVuY3Rpb24gKCkgewpyZXR1cm4gdGhpcy5fb3duZXJTaGFkeVJvb3RGb3JOb2RlKHRoaXMubm9kZSk7Cn0sCl9vd25lclNoYWR5Um9vdEZvck5vZGU6IGZ1bmN0aW9uIChub2RlKSB7CmlmICghbm9kZSkgewpyZXR1cm47Cn0KaWYgKG5vZGUuX293bmVyU2hhZHlSb290ID09PSB1bmRlZmluZWQpIHsKdmFyIHJvb3Q7CmlmIChub2RlLl9pc1NoYWR5Um9vdCkgewpyb290ID0gbm9kZTsKfSBlbHNlIHsKdmFyIHBhcmVudCA9IFBvbHltZXIuZG9tKG5vZGUpLnBhcmVudE5vZGU7CmlmIChwYXJlbnQpIHsKcm9vdCA9IHBhcmVudC5faXNTaGFkeVJvb3QgPyBwYXJlbnQgOiB0aGlzLl9vd25lclNoYWR5Um9vdEZvck5vZGUocGFyZW50KTsKfSBlbHNlIHsKcm9vdCA9IG51bGw7Cn0KfQpub2RlLl9vd25lclNoYWR5Um9vdCA9IHJvb3Q7Cn0KcmV0dXJuIG5vZGUuX293bmVyU2hhZHlSb290Owp9LApfbWF5YmVEaXN0cmlidXRlOiBmdW5jdGlvbiAobm9kZSwgcGFyZW50KSB7CnZhciBmcmFnQ29udGVudCA9IG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRE9DVU1FTlRfRlJBR01FTlRfTk9ERSAmJiAhbm9kZS5fX25vQ29udGVudCAmJiBQb2x5bWVyLmRvbShub2RlKS5xdWVyeVNlbGVjdG9yKENPTlRFTlQpOwp2YXIgd3JhcHBlZENvbnRlbnQgPSBmcmFnQ29udGVudCAmJiBQb2x5bWVyLmRvbShmcmFnQ29udGVudCkucGFyZW50Tm9kZS5ub2RlVHlwZSAhPT0gTm9kZS5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFOwp2YXIgaGFzQ29udGVudCA9IGZyYWdDb250ZW50IHx8IG5vZGUubG9jYWxOYW1lID09PSBDT05URU5UOwppZiAoaGFzQ29udGVudCkgewp2YXIgcm9vdCA9IHRoaXMuX293bmVyU2hhZHlSb290Rm9yTm9kZShwYXJlbnQpOwppZiAocm9vdCkgewp2YXIgaG9zdCA9IHJvb3QuaG9zdDsKdGhpcy5fbGF6eURpc3RyaWJ1dGUoaG9zdCk7Cn0KfQp2YXIgcGFyZW50TmVlZHNEaXN0ID0gdGhpcy5fcGFyZW50TmVlZHNEaXN0cmlidXRpb24ocGFyZW50KTsKaWYgKHBhcmVudE5lZWRzRGlzdCkgewp0aGlzLl9sYXp5RGlzdHJpYnV0ZShwYXJlbnQpOwp9CnJldHVybiBwYXJlbnROZWVkc0Rpc3QgfHwgaGFzQ29udGVudCAmJiAhd3JhcHBlZENvbnRlbnQ7Cn0sCl9tYXliZUFkZEluc2VydGlvblBvaW50OiBmdW5jdGlvbiAobm9kZSwgcGFyZW50KSB7CnZhciBhZGRlZDsKaWYgKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRE9DVU1FTlRfRlJBR01FTlRfTk9ERSAmJiAhbm9kZS5fX25vQ29udGVudCkgewp2YXIgYyQgPSBmYWN0b3J5KG5vZGUpLnF1ZXJ5U2VsZWN0b3JBbGwoQ09OVEVOVCk7CmZvciAodmFyIGkgPSAwLCBuLCBucCwgbmE7IGkgPCBjJC5sZW5ndGggJiYgKG4gPSBjJFtpXSk7IGkrKykgewpucCA9IGZhY3RvcnkobikucGFyZW50Tm9kZTsKaWYgKG5wID09PSBub2RlKSB7Cm5wID0gcGFyZW50Owp9Cm5hID0gdGhpcy5fbWF5YmVBZGRJbnNlcnRpb25Qb2ludChuLCBucCk7CmFkZGVkID0gYWRkZWQgfHwgbmE7Cn0KfSBlbHNlIGlmIChub2RlLmxvY2FsTmFtZSA9PT0gQ09OVEVOVCkgewpzYXZlTGlnaHRDaGlsZHJlbklmTmVlZGVkKHBhcmVudCk7CnNhdmVMaWdodENoaWxkcmVuSWZOZWVkZWQobm9kZSk7CmFkZGVkID0gdHJ1ZTsKfQpyZXR1cm4gYWRkZWQ7Cn0sCl90cnlSZW1vdmVVbmRpc3RyaWJ1dGVkTm9kZTogZnVuY3Rpb24gKG5vZGUpIHsKaWYgKHRoaXMubm9kZS5zaGFkeVJvb3QpIHsKdmFyIHBhcmVudCA9IGdldENvbXBvc2VkUGFyZW50KG5vZGUpOwppZiAocGFyZW50KSB7Cm5hdGl2ZVJlbW92ZUNoaWxkLmNhbGwocGFyZW50LCBub2RlKTsKfQpyZXR1cm4gdHJ1ZTsKfQp9LApfdXBkYXRlSW5zZXJ0aW9uUG9pbnRzOiBmdW5jdGlvbiAoaG9zdCkgewp2YXIgaSQgPSBob3N0LnNoYWR5Um9vdC5faW5zZXJ0aW9uUG9pbnRzID0gZmFjdG9yeShob3N0LnNoYWR5Um9vdCkucXVlcnlTZWxlY3RvckFsbChDT05URU5UKTsKZm9yICh2YXIgaSA9IDAsIGM7IGkgPCBpJC5sZW5ndGg7IGkrKykgewpjID0gaSRbaV07CnNhdmVMaWdodENoaWxkcmVuSWZOZWVkZWQoYyk7CnNhdmVMaWdodENoaWxkcmVuSWZOZWVkZWQoZmFjdG9yeShjKS5wYXJlbnROb2RlKTsKfQp9LApfbm9kZUhhc0xvZ2ljYWxDaGlsZHJlbjogZnVuY3Rpb24gKG5vZGUpIHsKcmV0dXJuIEJvb2xlYW4obm9kZS5fbGlnaHRDaGlsZHJlbiAhPT0gdW5kZWZpbmVkKTsKfSwKX3BhcmVudE5lZWRzRGlzdHJpYnV0aW9uOiBmdW5jdGlvbiAocGFyZW50KSB7CnJldHVybiBwYXJlbnQgJiYgcGFyZW50LnNoYWR5Um9vdCAmJiBoYXNJbnNlcnRpb25Qb2ludChwYXJlbnQuc2hhZHlSb290KTsKfSwKX3JlbW92ZU5vZGVGcm9tSG9zdDogZnVuY3Rpb24gKG5vZGUsIGVuc3VyZUNvbXBvc2VkUmVtb3ZhbCkgewp2YXIgaG9zdE5lZWRzRGlzdDsKdmFyIHJvb3Q7CnZhciBwYXJlbnQgPSBub2RlLl9saWdodFBhcmVudDsKaWYgKHBhcmVudCkgewpmYWN0b3J5KG5vZGUpLl9kaXN0cmlidXRlUGFyZW50KCk7CnJvb3QgPSB0aGlzLl9vd25lclNoYWR5Um9vdEZvck5vZGUobm9kZSk7CmlmIChyb290KSB7CnJvb3QuaG9zdC5fZWxlbWVudFJlbW92ZShub2RlKTsKaG9zdE5lZWRzRGlzdCA9IHRoaXMuX3JlbW92ZURpc3RyaWJ1dGVkQ2hpbGRyZW4ocm9vdCwgbm9kZSk7Cn0KdGhpcy5fcmVtb3ZlTG9naWNhbEluZm8obm9kZSwgbm9kZS5fbGlnaHRQYXJlbnQpOwp9CnRoaXMuX3JlbW92ZU93bmVyU2hhZHlSb290KG5vZGUpOwppZiAocm9vdCAmJiBob3N0TmVlZHNEaXN0KSB7CnRoaXMuX3VwZGF0ZUluc2VydGlvblBvaW50cyhyb290Lmhvc3QpOwp0aGlzLl9sYXp5RGlzdHJpYnV0ZShyb290Lmhvc3QpOwp9IGVsc2UgaWYgKGVuc3VyZUNvbXBvc2VkUmVtb3ZhbCkgewpyZW1vdmVGcm9tQ29tcG9zZWRQYXJlbnQoZ2V0Q29tcG9zZWRQYXJlbnQobm9kZSksIG5vZGUpOwp9Cn0sCl9yZW1vdmVEaXN0cmlidXRlZENoaWxkcmVuOiBmdW5jdGlvbiAocm9vdCwgY29udGFpbmVyKSB7CnZhciBob3N0TmVlZHNEaXN0Owp2YXIgaXAkID0gcm9vdC5faW5zZXJ0aW9uUG9pbnRzOwpmb3IgKHZhciBpID0gMDsgaSA8IGlwJC5sZW5ndGg7IGkrKykgewp2YXIgY29udGVudCA9IGlwJFtpXTsKaWYgKHRoaXMuX2NvbnRhaW5zKGNvbnRhaW5lciwgY29udGVudCkpIHsKdmFyIGRjJCA9IGZhY3RvcnkoY29udGVudCkuZ2V0RGlzdHJpYnV0ZWROb2RlcygpOwpmb3IgKHZhciBqID0gMDsgaiA8IGRjJC5sZW5ndGg7IGorKykgewpob3N0TmVlZHNEaXN0ID0gdHJ1ZTsKdmFyIG5vZGUgPSBkYyRbal07CnZhciBwYXJlbnQgPSBub2RlLnBhcmVudE5vZGU7CmlmIChwYXJlbnQpIHsKcmVtb3ZlRnJvbUNvbXBvc2VkUGFyZW50KHBhcmVudCwgbm9kZSk7Cm5hdGl2ZVJlbW92ZUNoaWxkLmNhbGwocGFyZW50LCBub2RlKTsKfQp9Cn0KfQpyZXR1cm4gaG9zdE5lZWRzRGlzdDsKfSwKX2NvbnRhaW5zOiBmdW5jdGlvbiAoY29udGFpbmVyLCBub2RlKSB7CndoaWxlIChub2RlKSB7CmlmIChub2RlID09IGNvbnRhaW5lcikgewpyZXR1cm4gdHJ1ZTsKfQpub2RlID0gZmFjdG9yeShub2RlKS5wYXJlbnROb2RlOwp9Cn0sCl9hZGROb2RlVG9Ib3N0OiBmdW5jdGlvbiAobm9kZSkgewp2YXIgcm9vdCA9IHRoaXMuZ2V0T3duZXJSb290KCk7CmlmIChyb290KSB7CnJvb3QuaG9zdC5fZWxlbWVudEFkZChub2RlKTsKfQp9LApfYWRkTG9naWNhbEluZm86IGZ1bmN0aW9uIChub2RlLCBjb250YWluZXIsIGluZGV4KSB7CnZhciBjaGlsZHJlbiA9IGZhY3RvcnkoY29udGFpbmVyKS5jaGlsZE5vZGVzOwppbmRleCA9IGluZGV4ID09PSB1bmRlZmluZWQgPyBjaGlsZHJlbi5sZW5ndGggOiBpbmRleDsKaWYgKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRE9DVU1FTlRfRlJBR01FTlRfTk9ERSkgewp2YXIgYyQgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChub2RlLmNoaWxkTm9kZXMpOwpmb3IgKHZhciBpID0gMCwgbjsgaSA8IGMkLmxlbmd0aCAmJiAobiA9IGMkW2ldKTsgaSsrKSB7CmNoaWxkcmVuLnNwbGljZShpbmRleCsrLCAwLCBuKTsKbi5fbGlnaHRQYXJlbnQgPSBjb250YWluZXI7Cn0KfSBlbHNlIHsKY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAwLCBub2RlKTsKbm9kZS5fbGlnaHRQYXJlbnQgPSBjb250YWluZXI7Cn0KfSwKX3JlbW92ZUxvZ2ljYWxJbmZvOiBmdW5jdGlvbiAobm9kZSwgY29udGFpbmVyKSB7CnZhciBjaGlsZHJlbiA9IGZhY3RvcnkoY29udGFpbmVyKS5jaGlsZE5vZGVzOwp2YXIgaW5kZXggPSBjaGlsZHJlbi5pbmRleE9mKG5vZGUpOwppZiAoaW5kZXggPCAwIHx8IGNvbnRhaW5lciAhPT0gbm9kZS5fbGlnaHRQYXJlbnQpIHsKdGhyb3cgRXJyb3IoJ1RoZSBub2RlIHRvIGJlIHJlbW92ZWQgaXMgbm90IGEgY2hpbGQgb2YgdGhpcyBub2RlJyk7Cn0KY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAxKTsKbm9kZS5fbGlnaHRQYXJlbnQgPSBudWxsOwp9LApfcmVtb3ZlT3duZXJTaGFkeVJvb3Q6IGZ1bmN0aW9uIChub2RlKSB7CmlmICh0aGlzLl9oYXNDYWNoZWRPd25lclJvb3Qobm9kZSkpIHsKdmFyIGMkID0gZmFjdG9yeShub2RlKS5jaGlsZE5vZGVzOwpmb3IgKHZhciBpID0gMCwgbCA9IGMkLmxlbmd0aCwgbjsgaSA8IGwgJiYgKG4gPSBjJFtpXSk7IGkrKykgewp0aGlzLl9yZW1vdmVPd25lclNoYWR5Um9vdChuKTsKfQp9Cm5vZGUuX293bmVyU2hhZHlSb290ID0gdW5kZWZpbmVkOwp9LApfZmlyc3RDb21wb3NlZE5vZGU6IGZ1bmN0aW9uIChjb250ZW50KSB7CnZhciBuJCA9IGZhY3RvcnkoY29udGVudCkuZ2V0RGlzdHJpYnV0ZWROb2RlcygpOwpmb3IgKHZhciBpID0gMCwgbCA9IG4kLmxlbmd0aCwgbiwgcCQ7IGkgPCBsICYmIChuID0gbiRbaV0pOyBpKyspIHsKcCQgPSBmYWN0b3J5KG4pLmdldERlc3RpbmF0aW9uSW5zZXJ0aW9uUG9pbnRzKCk7CmlmIChwJFtwJC5sZW5ndGggLSAxXSA9PT0gY29udGVudCkgewpyZXR1cm4gbjsKfQp9Cn0sCnF1ZXJ5U2VsZWN0b3I6IGZ1bmN0aW9uIChzZWxlY3RvcikgewpyZXR1cm4gdGhpcy5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKVswXTsKfSwKcXVlcnlTZWxlY3RvckFsbDogZnVuY3Rpb24gKHNlbGVjdG9yKSB7CnJldHVybiB0aGlzLl9xdWVyeShmdW5jdGlvbiAobikgewpyZXR1cm4gbWF0Y2hlc1NlbGVjdG9yLmNhbGwobiwgc2VsZWN0b3IpOwp9LCB0aGlzLm5vZGUpOwp9LApfcXVlcnk6IGZ1bmN0aW9uIChtYXRjaGVyLCBub2RlKSB7Cm5vZGUgPSBub2RlIHx8IHRoaXMubm9kZTsKdmFyIGxpc3QgPSBbXTsKdGhpcy5fcXVlcnlFbGVtZW50cyhmYWN0b3J5KG5vZGUpLmNoaWxkTm9kZXMsIG1hdGNoZXIsIGxpc3QpOwpyZXR1cm4gbGlzdDsKfSwKX3F1ZXJ5RWxlbWVudHM6IGZ1bmN0aW9uIChlbGVtZW50cywgbWF0Y2hlciwgbGlzdCkgewpmb3IgKHZhciBpID0gMCwgbCA9IGVsZW1lbnRzLmxlbmd0aCwgYzsgaSA8IGwgJiYgKGMgPSBlbGVtZW50c1tpXSk7IGkrKykgewppZiAoYy5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUpIHsKdGhpcy5fcXVlcnlFbGVtZW50KGMsIG1hdGNoZXIsIGxpc3QpOwp9Cn0KfSwKX3F1ZXJ5RWxlbWVudDogZnVuY3Rpb24gKG5vZGUsIG1hdGNoZXIsIGxpc3QpIHsKaWYgKG1hdGNoZXIobm9kZSkpIHsKbGlzdC5wdXNoKG5vZGUpOwp9CnRoaXMuX3F1ZXJ5RWxlbWVudHMoZmFjdG9yeShub2RlKS5jaGlsZE5vZGVzLCBtYXRjaGVyLCBsaXN0KTsKfSwKZ2V0RGVzdGluYXRpb25JbnNlcnRpb25Qb2ludHM6IGZ1bmN0aW9uICgpIHsKcmV0dXJuIHRoaXMubm9kZS5fZGVzdGluYXRpb25JbnNlcnRpb25Qb2ludHMgfHwgW107Cn0sCmdldERpc3RyaWJ1dGVkTm9kZXM6IGZ1bmN0aW9uICgpIHsKcmV0dXJuIHRoaXMubm9kZS5fZGlzdHJpYnV0ZWROb2RlcyB8fCBbXTsKfSwKcXVlcnlEaXN0cmlidXRlZEVsZW1lbnRzOiBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKdmFyIGMkID0gdGhpcy5jaGlsZE5vZGVzOwp2YXIgbGlzdCA9IFtdOwp0aGlzLl9kaXN0cmlidXRlZEZpbHRlcihzZWxlY3RvciwgYyQsIGxpc3QpOwpmb3IgKHZhciBpID0gMCwgbCA9IGMkLmxlbmd0aCwgYzsgaSA8IGwgJiYgKGMgPSBjJFtpXSk7IGkrKykgewppZiAoYy5sb2NhbE5hbWUgPT09IENPTlRFTlQpIHsKdGhpcy5fZGlzdHJpYnV0ZWRGaWx0ZXIoc2VsZWN0b3IsIGZhY3RvcnkoYykuZ2V0RGlzdHJpYnV0ZWROb2RlcygpLCBsaXN0KTsKfQp9CnJldHVybiBsaXN0Owp9LApfZGlzdHJpYnV0ZWRGaWx0ZXI6IGZ1bmN0aW9uIChzZWxlY3RvciwgbGlzdCwgcmVzdWx0cykgewpyZXN1bHRzID0gcmVzdWx0cyB8fCBbXTsKZm9yICh2YXIgaSA9IDAsIGwgPSBsaXN0Lmxlbmd0aCwgZDsgaSA8IGwgJiYgKGQgPSBsaXN0W2ldKTsgaSsrKSB7CmlmIChkLm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSAmJiBkLmxvY2FsTmFtZSAhPT0gQ09OVEVOVCAmJiBtYXRjaGVzU2VsZWN0b3IuY2FsbChkLCBzZWxlY3RvcikpIHsKcmVzdWx0cy5wdXNoKGQpOwp9Cn0KcmV0dXJuIHJlc3VsdHM7Cn0sCl9jbGVhcjogZnVuY3Rpb24gKCkgewp3aGlsZSAodGhpcy5jaGlsZE5vZGVzLmxlbmd0aCkgewp0aGlzLnJlbW92ZUNoaWxkKHRoaXMuY2hpbGROb2Rlc1swXSk7Cn0KfSwKc2V0QXR0cmlidXRlOiBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHsKdGhpcy5ub2RlLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7CnRoaXMuX2Rpc3RyaWJ1dGVQYXJlbnQoKTsKfSwKcmVtb3ZlQXR0cmlidXRlOiBmdW5jdGlvbiAobmFtZSkgewp0aGlzLm5vZGUucmVtb3ZlQXR0cmlidXRlKG5hbWUpOwp0aGlzLl9kaXN0cmlidXRlUGFyZW50KCk7Cn0sCl9kaXN0cmlidXRlUGFyZW50OiBmdW5jdGlvbiAoKSB7CmlmICh0aGlzLl9wYXJlbnROZWVkc0Rpc3RyaWJ1dGlvbih0aGlzLnBhcmVudE5vZGUpKSB7CnRoaXMuX2xhenlEaXN0cmlidXRlKHRoaXMucGFyZW50Tm9kZSk7Cn0KfSwKY2xvbmVOb2RlOiBmdW5jdGlvbiAoZGVlcCkgewp2YXIgbiA9IG5hdGl2ZUNsb25lTm9kZS5jYWxsKHRoaXMubm9kZSwgZmFsc2UpOwppZiAoZGVlcCkgewp2YXIgYyQgPSB0aGlzLmNoaWxkTm9kZXM7CnZhciBkID0gZmFjdG9yeShuKTsKZm9yICh2YXIgaSA9IDAsIG5jOyBpIDwgYyQubGVuZ3RoOyBpKyspIHsKbmMgPSBmYWN0b3J5KGMkW2ldKS5jbG9uZU5vZGUodHJ1ZSk7CmQuYXBwZW5kQ2hpbGQobmMpOwp9Cn0KcmV0dXJuIG47Cn0sCmltcG9ydE5vZGU6IGZ1bmN0aW9uIChleHRlcm5hbE5vZGUsIGRlZXApIHsKdmFyIGRvYyA9IHRoaXMubm9kZSBpbnN0YW5jZW9mIERvY3VtZW50ID8gdGhpcy5ub2RlIDogdGhpcy5ub2RlLm93bmVyRG9jdW1lbnQ7CnZhciBuID0gbmF0aXZlSW1wb3J0Tm9kZS5jYWxsKGRvYywgZXh0ZXJuYWxOb2RlLCBmYWxzZSk7CmlmIChkZWVwKSB7CnZhciBjJCA9IGZhY3RvcnkoZXh0ZXJuYWxOb2RlKS5jaGlsZE5vZGVzOwp2YXIgZCA9IGZhY3Rvcnkobik7CmZvciAodmFyIGkgPSAwLCBuYzsgaSA8IGMkLmxlbmd0aDsgaSsrKSB7Cm5jID0gZmFjdG9yeShkb2MpLmltcG9ydE5vZGUoYyRbaV0sIHRydWUpOwpkLmFwcGVuZENoaWxkKG5jKTsKfQp9CnJldHVybiBuOwp9Cn07Ck9iamVjdC5kZWZpbmVQcm9wZXJ0eShEb21BcGkucHJvdG90eXBlLCAnY2xhc3NMaXN0JywgewpnZXQ6IGZ1bmN0aW9uICgpIHsKaWYgKCF0aGlzLl9jbGFzc0xpc3QpIHsKdGhpcy5fY2xhc3NMaXN0ID0gbmV3IERvbUFwaS5DbGFzc0xpc3QodGhpcyk7Cn0KcmV0dXJuIHRoaXMuX2NsYXNzTGlzdDsKfSwKY29uZmlndXJhYmxlOiB0cnVlCn0pOwpEb21BcGkuQ2xhc3NMaXN0ID0gZnVuY3Rpb24gKGhvc3QpIHsKdGhpcy5kb21BcGkgPSBob3N0Owp0aGlzLm5vZGUgPSBob3N0Lm5vZGU7Cn07CkRvbUFwaS5DbGFzc0xpc3QucHJvdG90eXBlID0gewphZGQ6IGZ1bmN0aW9uICgpIHsKdGhpcy5ub2RlLmNsYXNzTGlzdC5hZGQuYXBwbHkodGhpcy5ub2RlLmNsYXNzTGlzdCwgYXJndW1lbnRzKTsKdGhpcy5kb21BcGkuX2Rpc3RyaWJ1dGVQYXJlbnQoKTsKfSwKcmVtb3ZlOiBmdW5jdGlvbiAoKSB7CnRoaXMubm9kZS5jbGFzc0xpc3QucmVtb3ZlLmFwcGx5KHRoaXMubm9kZS5jbGFzc0xpc3QsIGFyZ3VtZW50cyk7CnRoaXMuZG9tQXBpLl9kaXN0cmlidXRlUGFyZW50KCk7Cn0sCnRvZ2dsZTogZnVuY3Rpb24gKCkgewp0aGlzLm5vZGUuY2xhc3NMaXN0LnRvZ2dsZS5hcHBseSh0aGlzLm5vZGUuY2xhc3NMaXN0LCBhcmd1bWVudHMpOwp0aGlzLmRvbUFwaS5fZGlzdHJpYnV0ZVBhcmVudCgpOwp9LApjb250YWluczogZnVuY3Rpb24gKCkgewpyZXR1cm4gdGhpcy5ub2RlLmNsYXNzTGlzdC5jb250YWlucy5hcHBseSh0aGlzLm5vZGUuY2xhc3NMaXN0LCBhcmd1bWVudHMpOwp9Cn07CmlmICghU2V0dGluZ3MudXNlU2hhZG93KSB7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKERvbUFwaS5wcm90b3R5cGUsIHsKY2hpbGROb2RlczogewpnZXQ6IGZ1bmN0aW9uICgpIHsKdmFyIGMkID0gZ2V0TGlnaHRDaGlsZHJlbih0aGlzLm5vZGUpOwpyZXR1cm4gQXJyYXkuaXNBcnJheShjJCkgPyBjJCA6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGMkKTsKfSwKY29uZmlndXJhYmxlOiB0cnVlCn0sCmNoaWxkcmVuOiB7CmdldDogZnVuY3Rpb24gKCkgewpyZXR1cm4gQXJyYXkucHJvdG90eXBlLmZpbHRlci5jYWxsKHRoaXMuY2hpbGROb2RlcywgZnVuY3Rpb24gKG4pIHsKcmV0dXJuIG4ubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFOwp9KTsKfSwKY29uZmlndXJhYmxlOiB0cnVlCn0sCnBhcmVudE5vZGU6IHsKZ2V0OiBmdW5jdGlvbiAoKSB7CnJldHVybiB0aGlzLm5vZGUuX2xpZ2h0UGFyZW50IHx8IGdldENvbXBvc2VkUGFyZW50KHRoaXMubm9kZSk7Cn0sCmNvbmZpZ3VyYWJsZTogdHJ1ZQp9LApmaXJzdENoaWxkOiB7CmdldDogZnVuY3Rpb24gKCkgewpyZXR1cm4gdGhpcy5jaGlsZE5vZGVzWzBdOwp9LApjb25maWd1cmFibGU6IHRydWUKfSwKbGFzdENoaWxkOiB7CmdldDogZnVuY3Rpb24gKCkgewp2YXIgYyQgPSB0aGlzLmNoaWxkTm9kZXM7CnJldHVybiBjJFtjJC5sZW5ndGggLSAxXTsKfSwKY29uZmlndXJhYmxlOiB0cnVlCn0sCm5leHRTaWJsaW5nOiB7CmdldDogZnVuY3Rpb24gKCkgewp2YXIgYyQgPSB0aGlzLnBhcmVudE5vZGUgJiYgZmFjdG9yeSh0aGlzLnBhcmVudE5vZGUpLmNoaWxkTm9kZXM7CmlmIChjJCkgewpyZXR1cm4gYyRbQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChjJCwgdGhpcy5ub2RlKSArIDFdOwp9Cn0sCmNvbmZpZ3VyYWJsZTogdHJ1ZQp9LApwcmV2aW91c1NpYmxpbmc6IHsKZ2V0OiBmdW5jdGlvbiAoKSB7CnZhciBjJCA9IHRoaXMucGFyZW50Tm9kZSAmJiBmYWN0b3J5KHRoaXMucGFyZW50Tm9kZSkuY2hpbGROb2RlczsKaWYgKGMkKSB7CnJldHVybiBjJFtBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGMkLCB0aGlzLm5vZGUpIC0gMV07Cn0KfSwKY29uZmlndXJhYmxlOiB0cnVlCn0sCmZpcnN0RWxlbWVudENoaWxkOiB7CmdldDogZnVuY3Rpb24gKCkgewpyZXR1cm4gdGhpcy5jaGlsZHJlblswXTsKfSwKY29uZmlndXJhYmxlOiB0cnVlCn0sCmxhc3RFbGVtZW50Q2hpbGQ6IHsKZ2V0OiBmdW5jdGlvbiAoKSB7CnZhciBjJCA9IHRoaXMuY2hpbGRyZW47CnJldHVybiBjJFtjJC5sZW5ndGggLSAxXTsKfSwKY29uZmlndXJhYmxlOiB0cnVlCn0sCm5leHRFbGVtZW50U2libGluZzogewpnZXQ6IGZ1bmN0aW9uICgpIHsKdmFyIGMkID0gdGhpcy5wYXJlbnROb2RlICYmIGZhY3RvcnkodGhpcy5wYXJlbnROb2RlKS5jaGlsZHJlbjsKaWYgKGMkKSB7CnJldHVybiBjJFtBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGMkLCB0aGlzLm5vZGUpICsgMV07Cn0KfSwKY29uZmlndXJhYmxlOiB0cnVlCn0sCnByZXZpb3VzRWxlbWVudFNpYmxpbmc6IHsKZ2V0OiBmdW5jdGlvbiAoKSB7CnZhciBjJCA9IHRoaXMucGFyZW50Tm9kZSAmJiBmYWN0b3J5KHRoaXMucGFyZW50Tm9kZSkuY2hpbGRyZW47CmlmIChjJCkgewpyZXR1cm4gYyRbQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChjJCwgdGhpcy5ub2RlKSAtIDFdOwp9Cn0sCmNvbmZpZ3VyYWJsZTogdHJ1ZQp9LAp0ZXh0Q29udGVudDogewpnZXQ6IGZ1bmN0aW9uICgpIHsKdmFyIG50ID0gdGhpcy5ub2RlLm5vZGVUeXBlOwppZiAobnQgPT09IE5vZGUuVEVYVF9OT0RFIHx8IG50ID09PSBOb2RlLkNPTU1FTlRfTk9ERSkgewpyZXR1cm4gdGhpcy5ub2RlLnRleHRDb250ZW50Owp9IGVsc2Ugewp2YXIgdGMgPSBbXTsKZm9yICh2YXIgaSA9IDAsIGNuID0gdGhpcy5jaGlsZE5vZGVzLCBjOyBjID0gY25baV07IGkrKykgewppZiAoYy5ub2RlVHlwZSAhPT0gTm9kZS5DT01NRU5UX05PREUpIHsKdGMucHVzaChjLnRleHRDb250ZW50KTsKfQp9CnJldHVybiB0Yy5qb2luKCcnKTsKfQp9LApzZXQ6IGZ1bmN0aW9uICh0ZXh0KSB7CnZhciBudCA9IHRoaXMubm9kZS5ub2RlVHlwZTsKaWYgKG50ID09PSBOb2RlLlRFWFRfTk9ERSB8fCBudCA9PT0gTm9kZS5DT01NRU5UX05PREUpIHsKdGhpcy5ub2RlLnRleHRDb250ZW50ID0gdGV4dDsKfSBlbHNlIHsKdGhpcy5fY2xlYXIoKTsKaWYgKHRleHQpIHsKdGhpcy5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0ZXh0KSk7Cn0KfQp9LApjb25maWd1cmFibGU6IHRydWUKfSwKaW5uZXJIVE1MOiB7CmdldDogZnVuY3Rpb24gKCkgewp2YXIgbnQgPSB0aGlzLm5vZGUubm9kZVR5cGU7CmlmIChudCA9PT0gTm9kZS5URVhUX05PREUgfHwgbnQgPT09IE5vZGUuQ09NTUVOVF9OT0RFKSB7CnJldHVybiBudWxsOwp9IGVsc2UgewpyZXR1cm4gZ2V0SW5uZXJIVE1MKHRoaXMubm9kZSk7Cn0KfSwKc2V0OiBmdW5jdGlvbiAodGV4dCkgewp2YXIgbnQgPSB0aGlzLm5vZGUubm9kZVR5cGU7CmlmIChudCAhPT0gTm9kZS5URVhUX05PREUgfHwgbnQgIT09IE5vZGUuQ09NTUVOVF9OT0RFKSB7CnRoaXMuX2NsZWFyKCk7CnZhciBkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CmQuaW5uZXJIVE1MID0gdGV4dDsKdmFyIGMkID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZC5jaGlsZE5vZGVzKTsKZm9yICh2YXIgaSA9IDA7IGkgPCBjJC5sZW5ndGg7IGkrKykgewp0aGlzLmFwcGVuZENoaWxkKGMkW2ldKTsKfQp9Cn0sCmNvbmZpZ3VyYWJsZTogdHJ1ZQp9Cn0pOwpEb21BcGkucHJvdG90eXBlLl9nZXRDb21wb3NlZElubmVySFRNTCA9IGZ1bmN0aW9uICgpIHsKcmV0dXJuIGdldElubmVySFRNTCh0aGlzLm5vZGUsIHRydWUpOwp9Owp9IGVsc2Ugewp2YXIgZm9yd2FyZE1ldGhvZHMgPSBbCidjbG9uZU5vZGUnLAonYXBwZW5kQ2hpbGQnLAonaW5zZXJ0QmVmb3JlJywKJ3JlbW92ZUNoaWxkJywKJ3JlcGxhY2VDaGlsZCcKXTsKZm9yd2FyZE1ldGhvZHMuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkgewpEb21BcGkucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24gKCkgewpyZXR1cm4gdGhpcy5ub2RlW25hbWVdLmFwcGx5KHRoaXMubm9kZSwgYXJndW1lbnRzKTsKfTsKfSk7CkRvbUFwaS5wcm90b3R5cGUucXVlcnlTZWxlY3RvckFsbCA9IGZ1bmN0aW9uIChzZWxlY3RvcikgewpyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5ub2RlLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTsKfTsKRG9tQXBpLnByb3RvdHlwZS5nZXRPd25lclJvb3QgPSBmdW5jdGlvbiAoKSB7CnZhciBuID0gdGhpcy5ub2RlOwp3aGlsZSAobikgewppZiAobi5ub2RlVHlwZSA9PT0gTm9kZS5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFICYmIG4uaG9zdCkgewpyZXR1cm4gbjsKfQpuID0gbi5wYXJlbnROb2RlOwp9Cn07CkRvbUFwaS5wcm90b3R5cGUuaW1wb3J0Tm9kZSA9IGZ1bmN0aW9uIChleHRlcm5hbE5vZGUsIGRlZXApIHsKdmFyIGRvYyA9IHRoaXMubm9kZSBpbnN0YW5jZW9mIERvY3VtZW50ID8gdGhpcy5ub2RlIDogdGhpcy5ub2RlLm93bmVyRG9jdW1lbnQ7CnJldHVybiBkb2MuaW1wb3J0Tm9kZShleHRlcm5hbE5vZGUsIGRlZXApOwp9OwpEb21BcGkucHJvdG90eXBlLmdldERlc3RpbmF0aW9uSW5zZXJ0aW9uUG9pbnRzID0gZnVuY3Rpb24gKCkgewp2YXIgbiQgPSB0aGlzLm5vZGUuZ2V0RGVzdGluYXRpb25JbnNlcnRpb25Qb2ludHMgJiYgdGhpcy5ub2RlLmdldERlc3RpbmF0aW9uSW5zZXJ0aW9uUG9pbnRzKCk7CnJldHVybiBuJCA/IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKG4kKSA6IFtdOwp9OwpEb21BcGkucHJvdG90eXBlLmdldERpc3RyaWJ1dGVkTm9kZXMgPSBmdW5jdGlvbiAoKSB7CnZhciBuJCA9IHRoaXMubm9kZS5nZXREaXN0cmlidXRlZE5vZGVzICYmIHRoaXMubm9kZS5nZXREaXN0cmlidXRlZE5vZGVzKCk7CnJldHVybiBuJCA/IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKG4kKSA6IFtdOwp9OwpEb21BcGkucHJvdG90eXBlLl9kaXN0cmlidXRlUGFyZW50ID0gZnVuY3Rpb24gKCkgewp9OwpPYmplY3QuZGVmaW5lUHJvcGVydGllcyhEb21BcGkucHJvdG90eXBlLCB7CmNoaWxkTm9kZXM6IHsKZ2V0OiBmdW5jdGlvbiAoKSB7CnJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0aGlzLm5vZGUuY2hpbGROb2Rlcyk7Cn0sCmNvbmZpZ3VyYWJsZTogdHJ1ZQp9LApjaGlsZHJlbjogewpnZXQ6IGZ1bmN0aW9uICgpIHsKcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMubm9kZS5jaGlsZHJlbik7Cn0sCmNvbmZpZ3VyYWJsZTogdHJ1ZQp9LAp0ZXh0Q29udGVudDogewpnZXQ6IGZ1bmN0aW9uICgpIHsKcmV0dXJuIHRoaXMubm9kZS50ZXh0Q29udGVudDsKfSwKc2V0OiBmdW5jdGlvbiAodmFsdWUpIHsKcmV0dXJuIHRoaXMubm9kZS50ZXh0Q29udGVudCA9IHZhbHVlOwp9LApjb25maWd1cmFibGU6IHRydWUKfSwKaW5uZXJIVE1MOiB7CmdldDogZnVuY3Rpb24gKCkgewpyZXR1cm4gdGhpcy5ub2RlLmlubmVySFRNTDsKfSwKc2V0OiBmdW5jdGlvbiAodmFsdWUpIHsKcmV0dXJuIHRoaXMubm9kZS5pbm5lckhUTUwgPSB2YWx1ZTsKfSwKY29uZmlndXJhYmxlOiB0cnVlCn0KfSk7CnZhciBmb3J3YXJkUHJvcGVydGllcyA9IFsKJ3BhcmVudE5vZGUnLAonZmlyc3RDaGlsZCcsCidsYXN0Q2hpbGQnLAonbmV4dFNpYmxpbmcnLAoncHJldmlvdXNTaWJsaW5nJywKJ2ZpcnN0RWxlbWVudENoaWxkJywKJ2xhc3RFbGVtZW50Q2hpbGQnLAonbmV4dEVsZW1lbnRTaWJsaW5nJywKJ3ByZXZpb3VzRWxlbWVudFNpYmxpbmcnCl07CmZvcndhcmRQcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKT2JqZWN0LmRlZmluZVByb3BlcnR5KERvbUFwaS5wcm90b3R5cGUsIG5hbWUsIHsKZ2V0OiBmdW5jdGlvbiAoKSB7CnJldHVybiB0aGlzLm5vZGVbbmFtZV07Cn0sCmNvbmZpZ3VyYWJsZTogdHJ1ZQp9KTsKfSk7Cn0KdmFyIENPTlRFTlQgPSAnY29udGVudCc7CnZhciBmYWN0b3J5ID0gZnVuY3Rpb24gKG5vZGUsIHBhdGNoKSB7Cm5vZGUgPSBub2RlIHx8IGRvY3VtZW50OwppZiAoIW5vZGUuX19kb21BcGkpIHsKbm9kZS5fX2RvbUFwaSA9IG5ldyBEb21BcGkobm9kZSwgcGF0Y2gpOwp9CnJldHVybiBub2RlLl9fZG9tQXBpOwp9OwpQb2x5bWVyLmRvbSA9IGZ1bmN0aW9uIChvYmosIHBhdGNoKSB7CmlmIChvYmogaW5zdGFuY2VvZiBFdmVudCkgewpyZXR1cm4gUG9seW1lci5FdmVudEFwaS5mYWN0b3J5KG9iaik7Cn0gZWxzZSB7CnJldHVybiBmYWN0b3J5KG9iaiwgcGF0Y2gpOwp9Cn07ClBvbHltZXIuQmFzZS5leHRlbmQoUG9seW1lci5kb20sIHsKX2ZsdXNoR3VhcmQ6IDAsCl9GTFVTSF9NQVg6IDEwMCwKX25lZWRzVGFrZVJlY29yZHM6ICFQb2x5bWVyLlNldHRpbmdzLnVzZU5hdGl2ZUN1c3RvbUVsZW1lbnRzLApfZGVib3VuY2VyczogW10sCl9maW5pc2hEZWJvdW5jZXI6IG51bGwsCmZsdXNoOiBmdW5jdGlvbiAoKSB7CmZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fZGVib3VuY2Vycy5sZW5ndGg7IGkrKykgewp0aGlzLl9kZWJvdW5jZXJzW2ldLmNvbXBsZXRlKCk7Cn0KaWYgKHRoaXMuX2ZpbmlzaERlYm91bmNlcikgewp0aGlzLl9maW5pc2hEZWJvdW5jZXIuY29tcGxldGUoKTsKfQp0aGlzLl9mbHVzaFBvbHlmaWxscygpOwppZiAodGhpcy5fZGVib3VuY2Vycy5sZW5ndGggJiYgdGhpcy5fZmx1c2hHdWFyZCA8IHRoaXMuX0ZMVVNIX01BWCkgewp0aGlzLl9mbHVzaEd1YXJkKys7CnRoaXMuZmx1c2goKTsKfSBlbHNlIHsKaWYgKHRoaXMuX2ZsdXNoR3VhcmQgPj0gdGhpcy5fRkxVU0hfTUFYKSB7CmNvbnNvbGUud2FybignUG9seW1lci5kb20uZmx1c2ggYWJvcnRlZC4gRmx1c2ggbWF5IG5vdCBiZSBjb21wbGV0ZS4nKTsKfQp0aGlzLl9mbHVzaEd1YXJkID0gMDsKfQp9LApfZmx1c2hQb2x5ZmlsbHM6IGZ1bmN0aW9uICgpIHsKaWYgKHRoaXMuX25lZWRzVGFrZVJlY29yZHMpIHsKQ3VzdG9tRWxlbWVudHMudGFrZVJlY29yZHMoKTsKfQp9LAphZGREZWJvdW5jZXI6IGZ1bmN0aW9uIChkZWJvdW5jZXIpIHsKdGhpcy5fZGVib3VuY2Vycy5wdXNoKGRlYm91bmNlcik7CnRoaXMuX2ZpbmlzaERlYm91bmNlciA9IFBvbHltZXIuRGVib3VuY2UodGhpcy5fZmluaXNoRGVib3VuY2VyLCB0aGlzLl9maW5pc2hGbHVzaCk7Cn0sCl9maW5pc2hGbHVzaDogZnVuY3Rpb24gKCkgewpQb2x5bWVyLmRvbS5fZGVib3VuY2VycyA9IFtdOwp9Cn0pOwpmdW5jdGlvbiBnZXRMaWdodENoaWxkcmVuKG5vZGUpIHsKdmFyIGNoaWxkcmVuID0gbm9kZS5fbGlnaHRDaGlsZHJlbjsKcmV0dXJuIGNoaWxkcmVuID8gY2hpbGRyZW4gOiBub2RlLmNoaWxkTm9kZXM7Cn0KZnVuY3Rpb24gZ2V0Q29tcG9zZWRDaGlsZHJlbihub2RlKSB7CmlmICghbm9kZS5fY29tcG9zZWRDaGlsZHJlbikgewpub2RlLl9jb21wb3NlZENoaWxkcmVuID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwobm9kZS5jaGlsZE5vZGVzKTsKfQpyZXR1cm4gbm9kZS5fY29tcG9zZWRDaGlsZHJlbjsKfQpmdW5jdGlvbiBhZGRUb0NvbXBvc2VkUGFyZW50KHBhcmVudCwgbm9kZSwgcmVmX25vZGUpIHsKdmFyIGNoaWxkcmVuID0gZ2V0Q29tcG9zZWRDaGlsZHJlbihwYXJlbnQpOwp2YXIgaSA9IHJlZl9ub2RlID8gY2hpbGRyZW4uaW5kZXhPZihyZWZfbm9kZSkgOiAtMTsKaWYgKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRE9DVU1FTlRfRlJBR01FTlRfTk9ERSkgewp2YXIgZnJhZ0NoaWxkcmVuID0gZ2V0Q29tcG9zZWRDaGlsZHJlbihub2RlKTsKZm9yICh2YXIgaiA9IDA7IGogPCBmcmFnQ2hpbGRyZW4ubGVuZ3RoOyBqKyspIHsKYWRkTm9kZVRvQ29tcG9zZWRDaGlsZHJlbihmcmFnQ2hpbGRyZW5bal0sIHBhcmVudCwgY2hpbGRyZW4sIGkgKyBqKTsKfQpub2RlLl9jb21wb3NlZENoaWxkcmVuID0gbnVsbDsKfSBlbHNlIHsKYWRkTm9kZVRvQ29tcG9zZWRDaGlsZHJlbihub2RlLCBwYXJlbnQsIGNoaWxkcmVuLCBpKTsKfQp9CmZ1bmN0aW9uIGdldENvbXBvc2VkUGFyZW50KG5vZGUpIHsKcmV0dXJuIG5vZGUuX19wYXRjaGVkID8gbm9kZS5fY29tcG9zZWRQYXJlbnQgOiBub2RlLnBhcmVudE5vZGU7Cn0KZnVuY3Rpb24gYWRkTm9kZVRvQ29tcG9zZWRDaGlsZHJlbihub2RlLCBwYXJlbnQsIGNoaWxkcmVuLCBpKSB7Cm5vZGUuX2NvbXBvc2VkUGFyZW50ID0gcGFyZW50OwpjaGlsZHJlbi5zcGxpY2UoaSA+PSAwID8gaSA6IGNoaWxkcmVuLmxlbmd0aCwgMCwgbm9kZSk7Cn0KZnVuY3Rpb24gcmVtb3ZlRnJvbUNvbXBvc2VkUGFyZW50KHBhcmVudCwgbm9kZSkgewpub2RlLl9jb21wb3NlZFBhcmVudCA9IG51bGw7CmlmIChwYXJlbnQpIHsKdmFyIGNoaWxkcmVuID0gZ2V0Q29tcG9zZWRDaGlsZHJlbihwYXJlbnQpOwp2YXIgaSA9IGNoaWxkcmVuLmluZGV4T2Yobm9kZSk7CmlmIChpID49IDApIHsKY2hpbGRyZW4uc3BsaWNlKGksIDEpOwp9Cn0KfQpmdW5jdGlvbiBzYXZlTGlnaHRDaGlsZHJlbklmTmVlZGVkKG5vZGUpIHsKaWYgKCFub2RlLl9saWdodENoaWxkcmVuKSB7CnZhciBjJCA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKG5vZGUuY2hpbGROb2Rlcyk7CmZvciAodmFyIGkgPSAwLCBsID0gYyQubGVuZ3RoLCBjaGlsZDsgaSA8IGwgJiYgKGNoaWxkID0gYyRbaV0pOyBpKyspIHsKY2hpbGQuX2xpZ2h0UGFyZW50ID0gY2hpbGQuX2xpZ2h0UGFyZW50IHx8IG5vZGU7Cn0Kbm9kZS5fbGlnaHRDaGlsZHJlbiA9IGMkOwp9Cn0KZnVuY3Rpb24gaGFzSW5zZXJ0aW9uUG9pbnQocm9vdCkgewpyZXR1cm4gQm9vbGVhbihyb290ICYmIHJvb3QuX2luc2VydGlvblBvaW50cy5sZW5ndGgpOwp9CnZhciBwID0gRWxlbWVudC5wcm90b3R5cGU7CnZhciBtYXRjaGVzU2VsZWN0b3IgPSBwLm1hdGNoZXMgfHwgcC5tYXRjaGVzU2VsZWN0b3IgfHwgcC5tb3pNYXRjaGVzU2VsZWN0b3IgfHwgcC5tc01hdGNoZXNTZWxlY3RvciB8fCBwLm9NYXRjaGVzU2VsZWN0b3IgfHwgcC53ZWJraXRNYXRjaGVzU2VsZWN0b3I7CnJldHVybiB7CmdldExpZ2h0Q2hpbGRyZW46IGdldExpZ2h0Q2hpbGRyZW4sCmdldENvbXBvc2VkUGFyZW50OiBnZXRDb21wb3NlZFBhcmVudCwKZ2V0Q29tcG9zZWRDaGlsZHJlbjogZ2V0Q29tcG9zZWRDaGlsZHJlbiwKcmVtb3ZlRnJvbUNvbXBvc2VkUGFyZW50OiByZW1vdmVGcm9tQ29tcG9zZWRQYXJlbnQsCnNhdmVMaWdodENoaWxkcmVuSWZOZWVkZWQ6IHNhdmVMaWdodENoaWxkcmVuSWZOZWVkZWQsCm1hdGNoZXNTZWxlY3RvcjogbWF0Y2hlc1NlbGVjdG9yLApoYXNJbnNlcnRpb25Qb2ludDogaGFzSW5zZXJ0aW9uUG9pbnQsCmN0b3I6IERvbUFwaSwKZmFjdG9yeTogZmFjdG9yeQp9Owp9KCk7CihmdW5jdGlvbiAoKSB7ClBvbHltZXIuQmFzZS5fYWRkRmVhdHVyZSh7Cl9wcmVwU2hhZHk6IGZ1bmN0aW9uICgpIHsKdGhpcy5fdXNlQ29udGVudCA9IHRoaXMuX3VzZUNvbnRlbnQgfHwgQm9vbGVhbih0aGlzLl90ZW1wbGF0ZSk7Cn0sCl9wb29sQ29udGVudDogZnVuY3Rpb24gKCkgewppZiAodGhpcy5fdXNlQ29udGVudCkgewpzYXZlTGlnaHRDaGlsZHJlbklmTmVlZGVkKHRoaXMpOwp9Cn0sCl9zZXR1cFJvb3Q6IGZ1bmN0aW9uICgpIHsKaWYgKHRoaXMuX3VzZUNvbnRlbnQpIHsKdGhpcy5fY3JlYXRlTG9jYWxSb290KCk7CmlmICghdGhpcy5kYXRhSG9zdCkgewp1cGdyYWRlTGlnaHRDaGlsZHJlbih0aGlzLl9saWdodENoaWxkcmVuKTsKfQp9Cn0sCl9jcmVhdGVMb2NhbFJvb3Q6IGZ1bmN0aW9uICgpIHsKdGhpcy5zaGFkeVJvb3QgPSB0aGlzLnJvb3Q7CnRoaXMuc2hhZHlSb290Ll9kaXN0cmlidXRpb25DbGVhbiA9IGZhbHNlOwp0aGlzLnNoYWR5Um9vdC5faXNTaGFkeVJvb3QgPSB0cnVlOwp0aGlzLnNoYWR5Um9vdC5fZGlydHlSb290cyA9IFtdOwp2YXIgaSQgPSB0aGlzLnNoYWR5Um9vdC5faW5zZXJ0aW9uUG9pbnRzID0gIXRoaXMuX25vdGVzIHx8IHRoaXMuX25vdGVzLl9oYXNDb250ZW50ID8gdGhpcy5zaGFkeVJvb3QucXVlcnlTZWxlY3RvckFsbCgnY29udGVudCcpIDogW107CnNhdmVMaWdodENoaWxkcmVuSWZOZWVkZWQodGhpcy5zaGFkeVJvb3QpOwpmb3IgKHZhciBpID0gMCwgYzsgaSA8IGkkLmxlbmd0aDsgaSsrKSB7CmMgPSBpJFtpXTsKc2F2ZUxpZ2h0Q2hpbGRyZW5JZk5lZWRlZChjKTsKc2F2ZUxpZ2h0Q2hpbGRyZW5JZk5lZWRlZChjLnBhcmVudE5vZGUpOwp9CnRoaXMuc2hhZHlSb290Lmhvc3QgPSB0aGlzOwp9LApnZXQgZG9tSG9zdCgpIHsKdmFyIHJvb3QgPSBQb2x5bWVyLmRvbSh0aGlzKS5nZXRPd25lclJvb3QoKTsKcmV0dXJuIHJvb3QgJiYgcm9vdC5ob3N0Owp9LApkaXN0cmlidXRlQ29udGVudDogZnVuY3Rpb24gKHVwZGF0ZUluc2VydGlvblBvaW50cykgewppZiAodGhpcy5zaGFkeVJvb3QpIHsKdmFyIGRvbSA9IFBvbHltZXIuZG9tKHRoaXMpOwppZiAodXBkYXRlSW5zZXJ0aW9uUG9pbnRzKSB7CmRvbS5fdXBkYXRlSW5zZXJ0aW9uUG9pbnRzKHRoaXMpOwp9CnZhciBob3N0ID0gZ2V0VG9wRGlzdHJpYnV0aW5nSG9zdCh0aGlzKTsKZG9tLl9sYXp5RGlzdHJpYnV0ZShob3N0KTsKfQp9LApfZGlzdHJpYnV0ZUNvbnRlbnQ6IGZ1bmN0aW9uICgpIHsKaWYgKHRoaXMuX3VzZUNvbnRlbnQgJiYgIXRoaXMuc2hhZHlSb290Ll9kaXN0cmlidXRpb25DbGVhbikgewp0aGlzLl9iZWdpbkRpc3RyaWJ1dGUoKTsKdGhpcy5fZGlzdHJpYnV0ZURpcnR5Um9vdHMoKTsKdGhpcy5fZmluaXNoRGlzdHJpYnV0ZSgpOwp9Cn0sCl9iZWdpbkRpc3RyaWJ1dGU6IGZ1bmN0aW9uICgpIHsKaWYgKHRoaXMuX3VzZUNvbnRlbnQgJiYgaGFzSW5zZXJ0aW9uUG9pbnQodGhpcy5zaGFkeVJvb3QpKSB7CnRoaXMuX3Jlc2V0RGlzdHJpYnV0aW9uKCk7CnRoaXMuX2Rpc3RyaWJ1dGVQb29sKHRoaXMuc2hhZHlSb290LCB0aGlzLl9jb2xsZWN0UG9vbCgpKTsKfQp9LApfZGlzdHJpYnV0ZURpcnR5Um9vdHM6IGZ1bmN0aW9uICgpIHsKdmFyIGMkID0gdGhpcy5zaGFkeVJvb3QuX2RpcnR5Um9vdHM7CmZvciAodmFyIGkgPSAwLCBsID0gYyQubGVuZ3RoLCBjOyBpIDwgbCAmJiAoYyA9IGMkW2ldKTsgaSsrKSB7CmMuX2Rpc3RyaWJ1dGVDb250ZW50KCk7Cn0KdGhpcy5zaGFkeVJvb3QuX2RpcnR5Um9vdHMgPSBbXTsKfSwKX2ZpbmlzaERpc3RyaWJ1dGU6IGZ1bmN0aW9uICgpIHsKaWYgKHRoaXMuX3VzZUNvbnRlbnQpIHsKdGhpcy5zaGFkeVJvb3QuX2Rpc3RyaWJ1dGlvbkNsZWFuID0gdHJ1ZTsKaWYgKGhhc0luc2VydGlvblBvaW50KHRoaXMuc2hhZHlSb290KSkgewp0aGlzLl9jb21wb3NlVHJlZSgpOwp9IGVsc2UgewppZiAoIXRoaXMuc2hhZHlSb290Ll9oYXNEaXN0cmlidXRlZCkgewp0aGlzLnRleHRDb250ZW50ID0gJyc7CnRoaXMuX2NvbXBvc2VkQ2hpbGRyZW4gPSBudWxsOwp0aGlzLmFwcGVuZENoaWxkKHRoaXMuc2hhZHlSb290KTsKfSBlbHNlIHsKdmFyIGNoaWxkcmVuID0gdGhpcy5fY29tcG9zZU5vZGUodGhpcyk7CnRoaXMuX3VwZGF0ZUNoaWxkTm9kZXModGhpcywgY2hpbGRyZW4pOwp9Cn0KdGhpcy5zaGFkeVJvb3QuX2hhc0Rpc3RyaWJ1dGVkID0gdHJ1ZTsKfQp9LAplbGVtZW50TWF0Y2hlczogZnVuY3Rpb24gKHNlbGVjdG9yLCBub2RlKSB7Cm5vZGUgPSBub2RlIHx8IHRoaXM7CnJldHVybiBtYXRjaGVzU2VsZWN0b3IuY2FsbChub2RlLCBzZWxlY3Rvcik7Cn0sCl9yZXNldERpc3RyaWJ1dGlvbjogZnVuY3Rpb24gKCkgewp2YXIgY2hpbGRyZW4gPSBnZXRMaWdodENoaWxkcmVuKHRoaXMpOwpmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7CnZhciBjaGlsZCA9IGNoaWxkcmVuW2ldOwppZiAoY2hpbGQuX2Rlc3RpbmF0aW9uSW5zZXJ0aW9uUG9pbnRzKSB7CmNoaWxkLl9kZXN0aW5hdGlvbkluc2VydGlvblBvaW50cyA9IHVuZGVmaW5lZDsKfQppZiAoaXNJbnNlcnRpb25Qb2ludChjaGlsZCkpIHsKY2xlYXJEaXN0cmlidXRlZERlc3RpbmF0aW9uSW5zZXJ0aW9uUG9pbnRzKGNoaWxkKTsKfQp9CnZhciByb290ID0gdGhpcy5zaGFkeVJvb3Q7CnZhciBwJCA9IHJvb3QuX2luc2VydGlvblBvaW50czsKZm9yICh2YXIgaiA9IDA7IGogPCBwJC5sZW5ndGg7IGorKykgewpwJFtqXS5fZGlzdHJpYnV0ZWROb2RlcyA9IFtdOwp9Cn0sCl9jb2xsZWN0UG9vbDogZnVuY3Rpb24gKCkgewp2YXIgcG9vbCA9IFtdOwp2YXIgY2hpbGRyZW4gPSBnZXRMaWdodENoaWxkcmVuKHRoaXMpOwpmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7CnZhciBjaGlsZCA9IGNoaWxkcmVuW2ldOwppZiAoaXNJbnNlcnRpb25Qb2ludChjaGlsZCkpIHsKcG9vbC5wdXNoLmFwcGx5KHBvb2wsIGNoaWxkLl9kaXN0cmlidXRlZE5vZGVzKTsKfSBlbHNlIHsKcG9vbC5wdXNoKGNoaWxkKTsKfQp9CnJldHVybiBwb29sOwp9LApfZGlzdHJpYnV0ZVBvb2w6IGZ1bmN0aW9uIChub2RlLCBwb29sKSB7CnZhciBwJCA9IG5vZGUuX2luc2VydGlvblBvaW50czsKZm9yICh2YXIgaSA9IDAsIGwgPSBwJC5sZW5ndGgsIHA7IGkgPCBsICYmIChwID0gcCRbaV0pOyBpKyspIHsKdGhpcy5fZGlzdHJpYnV0ZUluc2VydGlvblBvaW50KHAsIHBvb2wpOwptYXliZVJlZGlzdHJpYnV0ZVBhcmVudChwLCB0aGlzKTsKfQp9LApfZGlzdHJpYnV0ZUluc2VydGlvblBvaW50OiBmdW5jdGlvbiAoY29udGVudCwgcG9vbCkgewp2YXIgYW55RGlzdHJpYnV0ZWQgPSBmYWxzZTsKZm9yICh2YXIgaSA9IDAsIGwgPSBwb29sLmxlbmd0aCwgbm9kZTsgaSA8IGw7IGkrKykgewpub2RlID0gcG9vbFtpXTsKaWYgKCFub2RlKSB7CmNvbnRpbnVlOwp9CmlmICh0aGlzLl9tYXRjaGVzQ29udGVudFNlbGVjdChub2RlLCBjb250ZW50KSkgewpkaXN0cmlidXRlTm9kZUludG8obm9kZSwgY29udGVudCk7CnBvb2xbaV0gPSB1bmRlZmluZWQ7CmFueURpc3RyaWJ1dGVkID0gdHJ1ZTsKfQp9CmlmICghYW55RGlzdHJpYnV0ZWQpIHsKdmFyIGNoaWxkcmVuID0gZ2V0TGlnaHRDaGlsZHJlbihjb250ZW50KTsKZm9yICh2YXIgaiA9IDA7IGogPCBjaGlsZHJlbi5sZW5ndGg7IGorKykgewpkaXN0cmlidXRlTm9kZUludG8oY2hpbGRyZW5bal0sIGNvbnRlbnQpOwp9Cn0KfSwKX2NvbXBvc2VUcmVlOiBmdW5jdGlvbiAoKSB7CnRoaXMuX3VwZGF0ZUNoaWxkTm9kZXModGhpcywgdGhpcy5fY29tcG9zZU5vZGUodGhpcykpOwp2YXIgcCQgPSB0aGlzLnNoYWR5Um9vdC5faW5zZXJ0aW9uUG9pbnRzOwpmb3IgKHZhciBpID0gMCwgbCA9IHAkLmxlbmd0aCwgcCwgcGFyZW50OyBpIDwgbCAmJiAocCA9IHAkW2ldKTsgaSsrKSB7CnBhcmVudCA9IHAuX2xpZ2h0UGFyZW50IHx8IHAucGFyZW50Tm9kZTsKaWYgKCFwYXJlbnQuX3VzZUNvbnRlbnQgJiYgcGFyZW50ICE9PSB0aGlzICYmIHBhcmVudCAhPT0gdGhpcy5zaGFkeVJvb3QpIHsKdGhpcy5fdXBkYXRlQ2hpbGROb2RlcyhwYXJlbnQsIHRoaXMuX2NvbXBvc2VOb2RlKHBhcmVudCkpOwp9Cn0KfSwKX2NvbXBvc2VOb2RlOiBmdW5jdGlvbiAobm9kZSkgewp2YXIgY2hpbGRyZW4gPSBbXTsKdmFyIGMkID0gZ2V0TGlnaHRDaGlsZHJlbihub2RlLnNoYWR5Um9vdCB8fCBub2RlKTsKZm9yICh2YXIgaSA9IDA7IGkgPCBjJC5sZW5ndGg7IGkrKykgewp2YXIgY2hpbGQgPSBjJFtpXTsKaWYgKGlzSW5zZXJ0aW9uUG9pbnQoY2hpbGQpKSB7CnZhciBkaXN0cmlidXRlZE5vZGVzID0gY2hpbGQuX2Rpc3RyaWJ1dGVkTm9kZXM7CmZvciAodmFyIGogPSAwOyBqIDwgZGlzdHJpYnV0ZWROb2Rlcy5sZW5ndGg7IGorKykgewp2YXIgZGlzdHJpYnV0ZWROb2RlID0gZGlzdHJpYnV0ZWROb2Rlc1tqXTsKaWYgKGlzRmluYWxEZXN0aW5hdGlvbihjaGlsZCwgZGlzdHJpYnV0ZWROb2RlKSkgewpjaGlsZHJlbi5wdXNoKGRpc3RyaWJ1dGVkTm9kZSk7Cn0KfQp9IGVsc2UgewpjaGlsZHJlbi5wdXNoKGNoaWxkKTsKfQp9CnJldHVybiBjaGlsZHJlbjsKfSwKX3VwZGF0ZUNoaWxkTm9kZXM6IGZ1bmN0aW9uIChjb250YWluZXIsIGNoaWxkcmVuKSB7CnZhciBjb21wb3NlZCA9IGdldENvbXBvc2VkQ2hpbGRyZW4oY29udGFpbmVyKTsKdmFyIHNwbGljZXMgPSBQb2x5bWVyLkFycmF5U3BsaWNlLmNhbGN1bGF0ZVNwbGljZXMoY2hpbGRyZW4sIGNvbXBvc2VkKTsKZm9yICh2YXIgaSA9IDAsIGQgPSAwLCBzOyBpIDwgc3BsaWNlcy5sZW5ndGggJiYgKHMgPSBzcGxpY2VzW2ldKTsgaSsrKSB7CmZvciAodmFyIGogPSAwLCBuOyBqIDwgcy5yZW1vdmVkLmxlbmd0aCAmJiAobiA9IHMucmVtb3ZlZFtqXSk7IGorKykgewppZiAoZ2V0Q29tcG9zZWRQYXJlbnQobikgPT09IGNvbnRhaW5lcikgewpyZW1vdmUobik7Cn0KY29tcG9zZWQuc3BsaWNlKHMuaW5kZXggKyBkLCAxKTsKfQpkIC09IHMuYWRkZWRDb3VudDsKfQpmb3IgKHZhciBpID0gMCwgcywgbmV4dDsgaSA8IHNwbGljZXMubGVuZ3RoICYmIChzID0gc3BsaWNlc1tpXSk7IGkrKykgewpuZXh0ID0gY29tcG9zZWRbcy5pbmRleF07CmZvciAodmFyIGogPSBzLmluZGV4LCBuOyBqIDwgcy5pbmRleCArIHMuYWRkZWRDb3VudDsgaisrKSB7Cm4gPSBjaGlsZHJlbltqXTsKaW5zZXJ0QmVmb3JlKGNvbnRhaW5lciwgbiwgbmV4dCk7CmNvbXBvc2VkLnNwbGljZShqLCAwLCBuKTsKfQp9CmVuc3VyZUNvbXBvc2VkUGFyZW50KGNvbnRhaW5lciwgY2hpbGRyZW4pOwp9LApfbWF0Y2hlc0NvbnRlbnRTZWxlY3Q6IGZ1bmN0aW9uIChub2RlLCBjb250ZW50RWxlbWVudCkgewp2YXIgc2VsZWN0ID0gY29udGVudEVsZW1lbnQuZ2V0QXR0cmlidXRlKCdzZWxlY3QnKTsKaWYgKCFzZWxlY3QpIHsKcmV0dXJuIHRydWU7Cn0Kc2VsZWN0ID0gc2VsZWN0LnRyaW0oKTsKaWYgKCFzZWxlY3QpIHsKcmV0dXJuIHRydWU7Cn0KaWYgKCEobm9kZSBpbnN0YW5jZW9mIEVsZW1lbnQpKSB7CnJldHVybiBmYWxzZTsKfQp2YXIgdmFsaWRTZWxlY3RvcnMgPSAvXig6bm90XCgpP1sqLiNbYS16QS1aX3xdLzsKaWYgKCF2YWxpZFNlbGVjdG9ycy50ZXN0KHNlbGVjdCkpIHsKcmV0dXJuIGZhbHNlOwp9CnJldHVybiB0aGlzLmVsZW1lbnRNYXRjaGVzKHNlbGVjdCwgbm9kZSk7Cn0sCl9lbGVtZW50QWRkOiBmdW5jdGlvbiAoKSB7Cn0sCl9lbGVtZW50UmVtb3ZlOiBmdW5jdGlvbiAoKSB7Cn0KfSk7CnZhciBzYXZlTGlnaHRDaGlsZHJlbklmTmVlZGVkID0gUG9seW1lci5Eb21BcGkuc2F2ZUxpZ2h0Q2hpbGRyZW5JZk5lZWRlZDsKdmFyIGdldExpZ2h0Q2hpbGRyZW4gPSBQb2x5bWVyLkRvbUFwaS5nZXRMaWdodENoaWxkcmVuOwp2YXIgbWF0Y2hlc1NlbGVjdG9yID0gUG9seW1lci5Eb21BcGkubWF0Y2hlc1NlbGVjdG9yOwp2YXIgaGFzSW5zZXJ0aW9uUG9pbnQgPSBQb2x5bWVyLkRvbUFwaS5oYXNJbnNlcnRpb25Qb2ludDsKdmFyIGdldENvbXBvc2VkQ2hpbGRyZW4gPSBQb2x5bWVyLkRvbUFwaS5nZXRDb21wb3NlZENoaWxkcmVuOwp2YXIgZ2V0Q29tcG9zZWRQYXJlbnQgPSBQb2x5bWVyLkRvbUFwaS5nZXRDb21wb3NlZFBhcmVudDsKdmFyIHJlbW92ZUZyb21Db21wb3NlZFBhcmVudCA9IFBvbHltZXIuRG9tQXBpLnJlbW92ZUZyb21Db21wb3NlZFBhcmVudDsKZnVuY3Rpb24gZGlzdHJpYnV0ZU5vZGVJbnRvKGNoaWxkLCBpbnNlcnRpb25Qb2ludCkgewppbnNlcnRpb25Qb2ludC5fZGlzdHJpYnV0ZWROb2Rlcy5wdXNoKGNoaWxkKTsKdmFyIHBvaW50cyA9IGNoaWxkLl9kZXN0aW5hdGlvbkluc2VydGlvblBvaW50czsKaWYgKCFwb2ludHMpIHsKY2hpbGQuX2Rlc3RpbmF0aW9uSW5zZXJ0aW9uUG9pbnRzID0gW2luc2VydGlvblBvaW50XTsKfSBlbHNlIHsKcG9pbnRzLnB1c2goaW5zZXJ0aW9uUG9pbnQpOwp9Cn0KZnVuY3Rpb24gY2xlYXJEaXN0cmlidXRlZERlc3RpbmF0aW9uSW5zZXJ0aW9uUG9pbnRzKGNvbnRlbnQpIHsKdmFyIGUkID0gY29udGVudC5fZGlzdHJpYnV0ZWROb2RlczsKaWYgKGUkKSB7CmZvciAodmFyIGkgPSAwOyBpIDwgZSQubGVuZ3RoOyBpKyspIHsKdmFyIGQgPSBlJFtpXS5fZGVzdGluYXRpb25JbnNlcnRpb25Qb2ludHM7CmlmIChkKSB7CmQuc3BsaWNlKGQuaW5kZXhPZihjb250ZW50KSArIDEsIGQubGVuZ3RoKTsKfQp9Cn0KfQpmdW5jdGlvbiBtYXliZVJlZGlzdHJpYnV0ZVBhcmVudChjb250ZW50LCBob3N0KSB7CnZhciBwYXJlbnQgPSBjb250ZW50Ll9saWdodFBhcmVudDsKaWYgKHBhcmVudCAmJiBwYXJlbnQuc2hhZHlSb290ICYmIGhhc0luc2VydGlvblBvaW50KHBhcmVudC5zaGFkeVJvb3QpICYmIHBhcmVudC5zaGFkeVJvb3QuX2Rpc3RyaWJ1dGlvbkNsZWFuKSB7CnBhcmVudC5zaGFkeVJvb3QuX2Rpc3RyaWJ1dGlvbkNsZWFuID0gZmFsc2U7Cmhvc3Quc2hhZHlSb290Ll9kaXJ0eVJvb3RzLnB1c2gocGFyZW50KTsKfQp9CmZ1bmN0aW9uIGlzRmluYWxEZXN0aW5hdGlvbihpbnNlcnRpb25Qb2ludCwgbm9kZSkgewp2YXIgcG9pbnRzID0gbm9kZS5fZGVzdGluYXRpb25JbnNlcnRpb25Qb2ludHM7CnJldHVybiBwb2ludHMgJiYgcG9pbnRzW3BvaW50cy5sZW5ndGggLSAxXSA9PT0gaW5zZXJ0aW9uUG9pbnQ7Cn0KZnVuY3Rpb24gaXNJbnNlcnRpb25Qb2ludChub2RlKSB7CnJldHVybiBub2RlLmxvY2FsTmFtZSA9PSAnY29udGVudCc7Cn0KdmFyIG5hdGl2ZUluc2VydEJlZm9yZSA9IEVsZW1lbnQucHJvdG90eXBlLmluc2VydEJlZm9yZTsKdmFyIG5hdGl2ZVJlbW92ZUNoaWxkID0gRWxlbWVudC5wcm90b3R5cGUucmVtb3ZlQ2hpbGQ7CmZ1bmN0aW9uIGluc2VydEJlZm9yZShwYXJlbnROb2RlLCBuZXdDaGlsZCwgcmVmQ2hpbGQpIHsKdmFyIG5ld0NoaWxkUGFyZW50ID0gZ2V0Q29tcG9zZWRQYXJlbnQobmV3Q2hpbGQpOwppZiAobmV3Q2hpbGRQYXJlbnQgIT09IHBhcmVudE5vZGUpIHsKcmVtb3ZlRnJvbUNvbXBvc2VkUGFyZW50KG5ld0NoaWxkUGFyZW50LCBuZXdDaGlsZCk7Cn0KcmVtb3ZlKG5ld0NoaWxkKTsKbmF0aXZlSW5zZXJ0QmVmb3JlLmNhbGwocGFyZW50Tm9kZSwgbmV3Q2hpbGQsIHJlZkNoaWxkIHx8IG51bGwpOwpuZXdDaGlsZC5fY29tcG9zZWRQYXJlbnQgPSBwYXJlbnROb2RlOwp9CmZ1bmN0aW9uIHJlbW92ZShub2RlKSB7CnZhciBwYXJlbnROb2RlID0gZ2V0Q29tcG9zZWRQYXJlbnQobm9kZSk7CmlmIChwYXJlbnROb2RlKSB7Cm5vZGUuX2NvbXBvc2VkUGFyZW50ID0gbnVsbDsKbmF0aXZlUmVtb3ZlQ2hpbGQuY2FsbChwYXJlbnROb2RlLCBub2RlKTsKfQp9CmZ1bmN0aW9uIGVuc3VyZUNvbXBvc2VkUGFyZW50KHBhcmVudCwgY2hpbGRyZW4pIHsKZm9yICh2YXIgaSA9IDAsIG47IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykgewpjaGlsZHJlbltpXS5fY29tcG9zZWRQYXJlbnQgPSBwYXJlbnQ7Cn0KfQpmdW5jdGlvbiBnZXRUb3BEaXN0cmlidXRpbmdIb3N0KGhvc3QpIHsKd2hpbGUgKGhvc3QgJiYgaG9zdE5lZWRzUmVkaXN0cmlidXRpb24oaG9zdCkpIHsKaG9zdCA9IGhvc3QuZG9tSG9zdDsKfQpyZXR1cm4gaG9zdDsKfQpmdW5jdGlvbiBob3N0TmVlZHNSZWRpc3RyaWJ1dGlvbihob3N0KSB7CnZhciBjJCA9IFBvbHltZXIuZG9tKGhvc3QpLmNoaWxkcmVuOwpmb3IgKHZhciBpID0gMCwgYzsgaSA8IGMkLmxlbmd0aDsgaSsrKSB7CmMgPSBjJFtpXTsKaWYgKGMubG9jYWxOYW1lID09PSAnY29udGVudCcpIHsKcmV0dXJuIGhvc3QuZG9tSG9zdDsKfQp9Cn0KdmFyIG5lZWRzVXBncmFkZSA9IHdpbmRvdy5DdXN0b21FbGVtZW50cyAmJiAhQ3VzdG9tRWxlbWVudHMudXNlTmF0aXZlOwpmdW5jdGlvbiB1cGdyYWRlTGlnaHRDaGlsZHJlbihjaGlsZHJlbikgewppZiAobmVlZHNVcGdyYWRlICYmIGNoaWxkcmVuKSB7CmZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHsKQ3VzdG9tRWxlbWVudHMudXBncmFkZShjaGlsZHJlbltpXSk7Cn0KfQp9Cn0oKSk7CmlmIChQb2x5bWVyLlNldHRpbmdzLnVzZVNoYWRvdykgewpQb2x5bWVyLkJhc2UuX2FkZEZlYXR1cmUoewpfcG9vbENvbnRlbnQ6IGZ1bmN0aW9uICgpIHsKfSwKX2JlZ2luRGlzdHJpYnV0ZTogZnVuY3Rpb24gKCkgewp9LApkaXN0cmlidXRlQ29udGVudDogZnVuY3Rpb24gKCkgewp9LApfZGlzdHJpYnV0ZUNvbnRlbnQ6IGZ1bmN0aW9uICgpIHsKfSwKX2ZpbmlzaERpc3RyaWJ1dGU6IGZ1bmN0aW9uICgpIHsKfSwKX2NyZWF0ZUxvY2FsUm9vdDogZnVuY3Rpb24gKCkgewp0aGlzLmNyZWF0ZVNoYWRvd1Jvb3QoKTsKdGhpcy5zaGFkb3dSb290LmFwcGVuZENoaWxkKHRoaXMucm9vdCk7CnRoaXMucm9vdCA9IHRoaXMuc2hhZG93Um9vdDsKfQp9KTsKfQpQb2x5bWVyLkRvbU1vZHVsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RvbS1tb2R1bGUnKTsKUG9seW1lci5CYXNlLl9hZGRGZWF0dXJlKHsKX3JlZ2lzdGVyRmVhdHVyZXM6IGZ1bmN0aW9uICgpIHsKdGhpcy5fcHJlcElzKCk7CnRoaXMuX3ByZXBBdHRyaWJ1dGVzKCk7CnRoaXMuX3ByZXBCZWhhdmlvcnMoKTsKdGhpcy5fcHJlcENvbnN0cnVjdG9yKCk7CnRoaXMuX3ByZXBUZW1wbGF0ZSgpOwp0aGlzLl9wcmVwU2hhZHkoKTsKfSwKX3ByZXBCZWhhdmlvcjogZnVuY3Rpb24gKGIpIHsKdGhpcy5fYWRkSG9zdEF0dHJpYnV0ZXMoYi5ob3N0QXR0cmlidXRlcyk7Cn0sCl9pbml0RmVhdHVyZXM6IGZ1bmN0aW9uICgpIHsKdGhpcy5fcG9vbENvbnRlbnQoKTsKdGhpcy5fcHVzaEhvc3QoKTsKdGhpcy5fc3RhbXBUZW1wbGF0ZSgpOwp0aGlzLl9wb3BIb3N0KCk7CnRoaXMuX21hcnNoYWxIb3N0QXR0cmlidXRlcygpOwp0aGlzLl9zZXR1cERlYm91bmNlcnMoKTsKdGhpcy5fbWFyc2hhbEJlaGF2aW9ycygpOwp0aGlzLl90cnlSZWFkeSgpOwp9LApfbWFyc2hhbEJlaGF2aW9yOiBmdW5jdGlvbiAoYikgewp9Cn0pOzwvc2NyaXB0PgoKCg==</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="1263733328" offset="0" length="8192" />
        <PacketInfo time="1263733343" offset="8192" length="1056" />
      </TcpPackets>
    </HTTPResponse>
  </HTTPTask>
</HTTPSnapshot>